\section[Macroscale stopping criteria for the expansion of computed manifolds]
{Macroscale stopping criteria for the expansion of \\\phantom{3.10} computed manifolds}
\label{sec:macroscale_stopping_criteria_for_the_expansion_of_computed_manifolds}

In principle, the process of developing manifold approximations by adding more
and more mesh points, organized in geodesic level sets, would continue as long
as the overall mesh quality was conserved (cf.\
\cref{sec:managing_mesh_accuracy}). The enforced (pseudo-)uniform expansion
radially outwards, inherent to the method of geodesic level sets, would then
yield a mesh providing a conservative estimate of the size of the
\emph{actual} manifold, as there is no particular reason to expect it to
expect the manifold to appear homogeneous, when viewed for the epicentre
of the computed level sets. With reasonable parameter choices, we became
able to generate large manifolds quite quickly. This lead us to enforce two
additional types of stopping criteria, based on what would happen if the
computed manifolds reached the edges of the computational domain, or folded
into themselves --- where the latter of the two will be described in the
imminent \cref{sub:continuous_self_intersection_checks}

The trajectories which are computed in order to identify new mesh points
(per the method described in
\cref{sec:revised_approach_to_computing_new_mesh_points}) frequently overstep
the domains within which the Cauchy-Green strain eigenvalues and -vectors
are defined in order to compute mesh points on or near the domain
boundaries. Thus, in order to resolve the behaviour of manifolds near the
edges of the domain of interest, the aforementioned strain characteristics
need to be computed in a region which \emph{contains} the domain of interest,
expanding beyond it in all directions. This is how we treated the case of
tidal flow in the Førde fjord (as outlined in
\cref{sec:flow_systems_defined_by_gridded_velocity_data}). For perfectly
periodic flow systems, such  as (either variant of) the ABC flow --- described
in \cref{sec:flow_systems_defined_by_analytical_velocity_fields} --- this
reduces to the trivial exercise of utilizing the inherent periodicity
(that is, provided that the computational domain is sufficiently large
to encompass at least one cycle along each direction).

\subsection{Continuous self-intersection checks}
\label{sub:continuous_self_intersection_checks}


\begin{framed}
    Based on criterion \eqref{eq:lcs_condition_b}, which states that there
    must be a uniquely defined direction of strongest repellence everywhere
    along a repelling LCS.

    Möller-Trumbore \parencite{moller1997fast} algorithm used to check
    if triangles intersect one another. Tolerance parameter $\epsilon=10^{-8}$.
    \emph{\textbf{BRUK den av $\epsilon$ eller $\varepsilon$ som ikke
    blir brukt for verifikasjon/falsifisering av ABD-kriterier}}


    Some intersections are considered worse than others.
    \begin{itemize}
        \item Triangles sharing a single vertex is the basis of our
            triangulation scheme, and should not be identified as problematic
        \item By the linear nature of our triangulation method, possibly
            worsened by numerical noise, some triangles could intersect in very
            `innocent' ways (i.e.,\ very `slightly') --- that is, if expanding
            the manifold by an additional subset, the new triangulations need
            not necessarily intersect with any of the previous.
        \item Accordingly, we sought to terminate the generation process
            if several consecutive level sets introduced (new) self-intersections.
            Managed by means of a permitted `intersection length', computed
            as the sum of $\Delta_{i}$ for each level set $\mathcal{M}_{i}$
            which introduced new intersections.
            If this `intersection length' exceeded $5\Delta_{\min}$, we
            subsequently terminated the manifold generation process,
            under the assumption (founded in empirical trials) that the
            intersection issue would then only worsen.
    \end{itemize}
\end{framed}

\input{mainmatter/method/figures/intersection_algrthm_flowchart}
\input{mainmatter/method/figures/moller_trumbore_specialcases}

