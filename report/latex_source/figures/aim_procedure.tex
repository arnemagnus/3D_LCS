\tdplotsetmaincoords{60}{20}

\begin{tikzpicture}[tdplot_main_coords]
    % Macro for the unit vector scale (i.e., the length of the unit vectors)
    \pgfmathsetmacro{\usclx}{1.85};
    \pgfmathsetmacro{\uscly}{2.15};
    \pgfmathsetmacro{\usclz}{1.35};

    % Macro for the axes parallel to the unit vectors
    \pgfmathsetmacro{\asclx}{7}
    \pgfmathsetmacro{\ascly}{7}
    \pgfmathsetmacro{\asclz}{3}

    % Macro for the vector separating origin point and aim point
    \pgfmathsetmacro{\x}{0.78*\asclx}
    \pgfmathsetmacro{\y}{0.64*\ascly}
    \pgfmathsetmacro{\z}{0.78*\asclz}

    % Set coordinates for origin point
    \coordinate (r) at (0,0,0);

    % Set coordinates for aiming point
    \coordinate (ra) at ($(r) + (\x,\y,\z)$);

    % Set coordinates for end points of unit vectors
    \coordinate (xi1) at ($(r) + (\usclx,0,0)$);
    \coordinate (xi2) at ($(r) + (0,\uscly,0)$);
    \coordinate (xi3) at ($(r) + (0,0,\usclz)$);

    % Set coordinates of orthogonal projection of aiming vector
    \coordinate (rort) at ($(r) + (0,0,\z)$);

    % Set coordinates of parallel projection of aiming vector
    \coordinate (rpar) at ($(r) + (\x,\y,0)$);

    % Shade plane spanned by xi1 and xi2
    \draw[fill=gray!15,draw opacity = 0] (r) -- ($(r)+(\asclx,0,0)$) -- ($(r)+(\asclx,\ascly,0)$) -- ($(r)+(0,\ascly,0)$) -- cycle;

    % Draw axes parallel to unit vectors
    \draw[color=gray!80] (r) -- ($(r) + (\asclx,0,0)$); % xi1
    \draw[color=gray!80] (r) -- ($(r) + (0,\ascly,0)$); % xi2
    \draw[color=gray!80] (r) -- ($(r) + (0,0,\asclz)$); % xi3

    % Draw unit vectors
	\getangle(r)(xi1)b;
    \draw[->,very thick,color=black!90] (r) -- (xi1) node[midway,below,rotate=\angleb]{$\vct{\xi}_{1}(\vct{r})$};
	\getangle(r)(xi2)b;
    \draw[->,very thick,color=black!90] (r) -- (xi2) node[above right=-0.25cm and -0.25cm,rotate=\angleb] {$\vct{\xi}_{2}(\vct{r})$};
    \draw[->,very thick,color=black!90] (r) -- (xi3) node[midway,left]{$\vct{\xi}_{3}(\vct{r})$};

    % Draw guide lines to orthogonal component of aim vector
    \draw[dashed,stroke=black!65] (ra) -- (rort);

    % Draw guide lines to parallel component of aim vector
    \draw[dashed,stroke=black!65] (ra) -- (rpar);


    % Draw parallel component of aim vector
	\getangle(r)(rpar)b;
    \draw[->,thick] (r) -- (rpar) node[midway,below,rotate=\angleb]{$\vct{f}(\vct{r},\vct{r}_{\mathrm{aim}})$};

    % Draw aim point
    \draw[fill=gray!10,stroke=black!90] (ra) circle(2.5pt) node[right]{$\vct{r}_{\mathrm{aim}}$};
    % Draw nonmodified aim vector
    \draw[->,stroke=black!90,thick,densely dashed,middle segment = 1] (r) -- (ra);

    % Draw origin point
    \draw[fill=gray!10,stroke=black!90,fill opacity=1] (r) circle(2.5pt) node[below left = 1pt and 1pt] {$\vct{r}$};


\end{tikzpicture}
