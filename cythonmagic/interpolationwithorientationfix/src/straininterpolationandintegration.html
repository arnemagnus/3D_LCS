<!DOCTYPE html>
<!-- Generated by Cython 0.28.2 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: straininterpolationandintegration.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.2</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="straininterpolationandintegration.cpp">straininterpolationandintegration.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="sd">This module contains Cython extension types which:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="sd">1) Facilitate linear and cubic B-spline interpolation of vector fields in R^3,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="sd">   with a twist indended to combat orientational discontinuities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="sd">2) Facilitate the approximation of three-dimensional manifolds defined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="sd">   as being everywhere orthogonal to a (stationary) vector field, by means</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="sd">   of a slight modification of the method of geodesic level sets.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="sd">The B-spline interpolation routines make use of the Bspline-Fortran library,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="sd">which is available at</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="sd">    https://github.com/jacobwilliams/bspline-fortran</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="sd">Extension types defined here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="sd">    LinearSpecialInterpolator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>: <span class="sd">    CubicSpecialInterpolator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: <span class="sd">    StrainDirectionGenerator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="sd">    Dp87Strain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="sd">Written by Arne Magnus T. Løken as part of my master&#39;s thesis work in physics</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="sd">at NTNU, spring 2018.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="sd">Version: 1.0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0030</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fmod</span> <span class="k">as</span> <span class="n">c_fmod</span><span class="p">,</span> <span class="n">floor</span> <span class="k">as</span> <span class="n">c_floor</span><span class="p">,</span> <span class="nb">pow</span> <span class="k">as</span> <span class="n">c_pow</span><span class="p">,</span> <span class="n">fabs</span> <span class="k">as</span> <span class="n">c_fabs</span><span class="p">,</span> <span class="n">copysign</span> <span class="k">as</span> <span class="n">c_copysign</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="k">from</span> <span class="nn">scipy.linalg.cython_blas</span> <span class="k">cimport</span> <span class="n">daxpy</span> <span class="k">as</span> <span class="n">scp_daxpy</span><span class="p">,</span> <span class="n">dcopy</span> <span class="k">as</span> <span class="n">scp_dcopy</span><span class="p">,</span>\</pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:                                       <span class="n">ddot</span> <span class="k">as</span> <span class="n">scp_ddot</span><span class="p">,</span> <span class="n">dnrm2</span> <span class="k">as</span> <span class="n">scp_dnrm2</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>:                                       <span class="n">dscal</span> <span class="k">as</span> <span class="n">scp_dscal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0042</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">daxpy</span><span class="p">(</span><span class="nb">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">double</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCX</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCY</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_daxpy(int __pyx_v_N, double __pyx_v_alpha, __Pyx_memviewslice &amp;__pyx_v_x, int __pyx_v_INCX, __Pyx_memviewslice &amp;__pyx_v_y, int __pyx_v_INCY) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0043</span>:     <span class="c"># y &lt;- ax + y</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0044</span>:     <span class="n">scp_daxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alpha</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCY</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_f_5scipy_6linalg_11cython_blas_daxpy((&amp;__pyx_v_N), (&amp;__pyx_v_alpha), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_1)) )))), (&amp;__pyx_v_INCX), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_2)) )))), (&amp;__pyx_v_INCY));
</pre><pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0049</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">dcopy</span><span class="p">(</span><span class="nb">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCX</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCY</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_dcopy(int __pyx_v_N, __Pyx_memviewslice &amp;__pyx_v_x, int __pyx_v_INCX, __Pyx_memviewslice &amp;__pyx_v_y, int __pyx_v_INCY) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0050</span>:     <span class="c"># y &lt;- x</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0051</span>:     <span class="n">scp_dcopy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCY</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_f_5scipy_6linalg_11cython_blas_dcopy((&amp;__pyx_v_N), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_1)) )))), (&amp;__pyx_v_INCX), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_2)) )))), (&amp;__pyx_v_INCY));
</pre><pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">ddot</span><span class="p">(</span><span class="nb">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCX</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCY</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_33straininterpolationandintegration_ddot(int __pyx_v_N, __Pyx_memviewslice &amp;__pyx_v_x, int __pyx_v_INCX, __Pyx_memviewslice &amp;__pyx_v_y, int __pyx_v_INCY) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0057</span>:     <span class="c"># return xT*y</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>:     <span class="k">return</span> <span class="n">scp_ddot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCY</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_f_5scipy_6linalg_11cython_blas_ddot((&amp;__pyx_v_N), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_1)) )))), (&amp;__pyx_v_INCX), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_2)) )))), (&amp;__pyx_v_INCY));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0063</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dnrm2</span><span class="p">(</span><span class="nb">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCX</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_33straininterpolationandintegration_dnrm2(int __pyx_v_N, __Pyx_memviewslice &amp;__pyx_v_x, int __pyx_v_INCX) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0064</span>:     <span class="c"># return (xT*t)**0.5</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>:     <span class="k">return</span> <span class="n">scp_dnrm2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCX</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_r = __pyx_f_5scipy_6linalg_11cython_blas_dnrm2((&amp;__pyx_v_N), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_1)) )))), (&amp;__pyx_v_INCX));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0070</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">dscal</span><span class="p">(</span><span class="nb">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">double</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">INCX</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_dscal(int __pyx_v_N, double __pyx_v_alpha, __Pyx_memviewslice &amp;__pyx_v_x, int __pyx_v_INCX) {
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0071</span>:     <span class="c"># x &lt;- alpha*x</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>:     <span class="n">scp_dscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">alpha</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">INCX</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_f_5scipy_6linalg_11cython_blas_dscal((&amp;__pyx_v_N), (&amp;__pyx_v_alpha), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_1)) )))), (&amp;__pyx_v_INCX));
</pre><pre class="cython line score-0">&#xA0;<span class="">0073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_cy_cross_product_</span><span class="p">(</span><span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">u</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">v</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">ret</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration__cy_cross_product_(__Pyx_memviewslice __pyx_v_u, __Pyx_memviewslice __pyx_v_v, __Pyx_memviewslice &amp;__pyx_v_ret) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cy_cross_product_", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0078</span>:     <span class="c"># ret = u x v</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0079</span>:     <span class="n">ret</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 1;
  __pyx_t_2 = 2;
  __pyx_t_3 = 2;
  __pyx_t_4 = 1;
  __pyx_t_5 = 0;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_ret.data) + __pyx_t_5)) )) = (((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_1)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_2)) )))) - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_3)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_4)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>:     <span class="n">ret</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 0;
  __pyx_t_7 = 2;
  __pyx_t_8 = 2;
  __pyx_t_9 = 0;
  __pyx_t_10 = 1;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_ret.data) + __pyx_t_10)) )) = (-(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_6)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_7)) )))) - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_8)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_9)) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0081</span>:     <span class="n">ret</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = 0;
  __pyx_t_12 = 1;
  __pyx_t_13 = 1;
  __pyx_t_14 = 0;
  __pyx_t_15 = 2;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_ret.data) + __pyx_t_15)) )) = (((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_11)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_12)) )))) - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_u.data) + __pyx_t_13)) ))) * (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_v.data) + __pyx_t_14)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0085</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_cy_normalize_</span><span class="p">(</span><span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">v</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration__cy_normalize_(__Pyx_memviewslice __pyx_v_v) {
  int __pyx_v_N;
  int __pyx_v_INCX;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cy_normalize_", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0086</span>:     <span class="c"># v &lt;- v / ||v||_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:         <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_v.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>:         <span class="nb">int</span> <span class="n">INCX</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_INCX = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>:     <span class="k">while</span><span class="p">(</span><span class="n">dnrm2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">INCX</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__pyx_f_33straininterpolationandintegration_dnrm2(__pyx_v_N, __pyx_v_v, __pyx_v_INCX) &lt; 0.0001) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>:         <span class="n">dscal</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mf">100</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">INCX</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(__pyx_v_N, 100.0, __pyx_v_v, __pyx_v_INCX);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:     <span class="n">dscal</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mf">1</span><span class="o">/</span><span class="n">dnrm2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">INCX</span><span class="p">),</span><span class="n">v</span><span class="p">,</span><span class="n">INCX</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dscal(__pyx_v_N, (1.0 / __pyx_f_33straininterpolationandintegration_dnrm2(__pyx_v_N, __pyx_v_v, __pyx_v_INCX)), __pyx_v_v, __pyx_v_INCX);
</pre><pre class="cython line score-0">&#xA0;<span class="">0093</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="c"># Exposing the interfaced Fortran functions (via a C++ class)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;linkto.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>:     <span class="n">cppclass</span> <span class="n">ItpCont</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>:         <span class="n">ItpCont</span><span class="p">()</span> <span class="k">except</span> <span class="o">+</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>:         <span class="n">void</span> <span class="n">init_interp</span><span class="p">(</span><span class="n">double</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>:                 <span class="nb">int</span> <span class="n">kx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ky</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ny</span><span class="p">,</span> <span class="nb">int</span> <span class="n">nz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ext</span><span class="p">)</span> <span class="k">except</span> <span class="o">+</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>:         <span class="n">double</span> <span class="n">eval_interp</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="n">z</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dy</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dz</span><span class="p">)</span> <span class="k">except</span> <span class="o">+</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>:         <span class="n">void</span> <span class="n">kill_interp</span><span class="p">()</span> <span class="k">except</span> <span class="o">+</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="c"># In-house wrapper for the bspline-3d Fortran class</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">internal</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0105</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">SplineInterpolator</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator {
  PyObject_HEAD
  struct __pyx_vtabstruct_33straininterpolationandintegration_SplineInterpolator *__pyx_vtab;
  ItpCont *interp;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_SplineInterpolator {
  void (*_ev_)(struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *, double, double, double, int, int, int, int, double *);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_SplineInterpolator *__pyx_vtabptr_33straininterpolationandintegration_SplineInterpolator;

</pre><pre class="cython line score-0">&#xA0;<span class="">0106</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>:         <span class="n">ItpCont</span> <span class="o">*</span><span class="n">interp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0111</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">y</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">z</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">f</span><span class="p">,</span></pre>
<pre class='cython code score-98 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_18SplineInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_18SplineInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_f = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_kx;
  int __pyx_v_ky;
  int __pyx_v_kz;
  int __pyx_v_extrap;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_z,&amp;__pyx_n_s_f,&amp;__pyx_n_s_kx,&amp;__pyx_n_s_ky,&amp;__pyx_n_s_kz,&amp;__pyx_n_s_extrap,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 1); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 2); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_f)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 3); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 4); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ky)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 5); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 6); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_extrap)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 7); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_x = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(1, 111, __pyx_L3_error)</span>
    __pyx_v_y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(1, 111, __pyx_L3_error)</span>
    __pyx_v_z = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 111, __pyx_L3_error)</span>
    __pyx_v_f = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_f.memview)) __PYX_ERR(1, 111, __pyx_L3_error)</span>
    __pyx_v_kx = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_kx == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 112, __pyx_L3_error)</span>
    __pyx_v_ky = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_ky == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 112, __pyx_L3_error)</span>
    __pyx_v_kz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_kz == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 112, __pyx_L3_error)</span>
    __pyx_v_extrap = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[7]); if (unlikely((__pyx_v_extrap == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 112, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 111, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.SplineInterpolator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_18SplineInterpolator___cinit__(((struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_f, __pyx_v_kx, __pyx_v_ky, __pyx_v_kz, __pyx_v_extrap);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_18SplineInterpolator___cinit__(struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_z, __Pyx_memviewslice __pyx_v_f, int __pyx_v_kx, int __pyx_v_ky, int __pyx_v_kz, int __pyx_v_extrap) {
  int __pyx_v_ext;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.SplineInterpolator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_f, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0112</span>:             <span class="nb">int</span> <span class="n">kx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ky</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kz</span><span class="p">,</span> <span class="n">bint</span> <span class="n">extrap</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>:             <span class="nb">int</span> <span class="n">ext</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0115</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">interp</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ItpCont</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = new ItpCont();
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 115, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;interp = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0116</span>:         <span class="k">if</span> <span class="n">extrap</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_extrap != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0117</span>:             <span class="n">ext</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ext = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0118</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>:             <span class="n">ext</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_ext = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0120</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="o">.</span><span class="n">init_interp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">f</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">ext</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  try {
    __pyx_v_self-&gt;interp-&gt;init_interp((&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_3)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_4)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_5)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_f.data) + __pyx_t_6)) )))), __pyx_v_kx, __pyx_v_ky, __pyx_v_kz, (__pyx_v_x.shape[0]), (__pyx_v_y.shape[0]), (__pyx_v_z.shape[0]), __pyx_v_ext);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 120, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_ev_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="n">z</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ky</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kz</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kq</span><span class="p">,</span> <span class="n">double</span><span class="o">*</span><span class="n">ret</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_33straininterpolationandintegration_18SplineInterpolator__ev_(struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *__pyx_v_self, double __pyx_v_x, double __pyx_v_y, double __pyx_v_z, int __pyx_v_kx, int __pyx_v_ky, int __pyx_v_kz, CYTHON_UNUSED int __pyx_v_kq, double *__pyx_v_ret) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_ev_", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("straininterpolationandintegration.SplineInterpolator._ev_", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>:         <span class="n">ret</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp</span><span class="o">.</span><span class="n">eval_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = __pyx_v_self-&gt;interp-&gt;eval_interp(__pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_kx, __pyx_v_ky, __pyx_v_kz);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 122, __pyx_L1_error)</span>
  }
  (__pyx_v_ret[0]) = __pyx_t_1;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0123</span>:     <span class="k">def</span> <span class="nf">__dealoc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_18SplineInterpolator_3__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_18SplineInterpolator_3__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__ (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_18SplineInterpolator_2__dealoc__(((struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_18SplineInterpolator_2__dealoc__(struct __pyx_obj_33straininterpolationandintegration_SplineInterpolator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;interp != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:             <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp</span></pre>
<pre class='cython code score-0 '>    delete __pyx_v_self-&gt;interp;
</pre><pre class="cython line score-0">&#xA0;<span class="">0126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="c"># Hidden superclass, mirroring a virtual superclass in C++.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="c"># Intended to be subclassed, and/or sent into other extension types defined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="c"># below.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">internal</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0131</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">InterpolatorWithOrientationFix</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix {
  PyObject_HEAD
  struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_vtab;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix {
  void (*_interpolate_xi_)(struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *, __Pyx_memviewslice, __Pyx_memviewslice &amp;);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_vtabptr_33straininterpolationandintegration_InterpolatorWithOrientationFix;

</pre><pre class="cython line score-103" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0132</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">y</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">z</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-103 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED int __pyx_v_kx;
  CYTHON_UNUSED int __pyx_v_ky;
  CYTHON_UNUSED int __pyx_v_kz;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_z,&amp;__pyx_n_s_xi,&amp;__pyx_n_s_kx,&amp;__pyx_n_s_ky,&amp;__pyx_n_s_kz,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xi)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ky)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_x = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(1, 132, __pyx_L3_error)</span>
    __pyx_v_y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(1, 132, __pyx_L3_error)</span>
    __pyx_v_z = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 132, __pyx_L3_error)</span>
    __pyx_v_xi = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_d_dc_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xi.memview)) __PYX_ERR(1, 133, __pyx_L3_error)</span>
    __pyx_v_kx = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_kx == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L3_error)</span>
    __pyx_v_ky = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_ky == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L3_error)</span>
    __pyx_v_kz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_kz == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.InterpolatorWithOrientationFix.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_x.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "x"); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_y.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "y"); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_z.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "z"); <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_xi.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "xi"); <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix___init__(((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_xi, __pyx_v_kx, __pyx_v_ky, __pyx_v_kz);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix___init__(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_x, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_y, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_z, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_xi, CYTHON_UNUSED int __pyx_v_kx, CYTHON_UNUSED int __pyx_v_ky, CYTHON_UNUSED int __pyx_v_kz) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);

  /* function exit code */
  __pyx_r = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0133</span>:                        <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kx</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ky</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kz</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0135</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_3__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(1, 135, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.InterpolatorWithOrientationFix.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_pos.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "pos"); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix_2__call__(((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self), __pyx_v_pos);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix_2__call__(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_pos) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0136</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0137</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_interpolate_xi_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">ret</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_30InterpolatorWithOrientationFix__interpolate_xi_(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_pos, CYTHON_UNUSED __Pyx_memviewslice &amp;__pyx_v_ret) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interpolate_xi_", 0);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0138</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0139</span>:     <span class="k">def</span> <span class="nf">__dealoc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_5__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_30InterpolatorWithOrientationFix_5__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__ (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix_4__dealoc__(((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_30InterpolatorWithOrientationFix_4__dealoc__(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0140</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">LinearSpecialInterpolator</span><span class="p">(</span><span class="n">InterpolatorWithOrientationFix</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator {
  struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix __pyx_base;
  __Pyx_memviewslice xi;
  double x_min;
  double x_max;
  double y_min;
  double y_max;
  double z_min;
  double z_max;
  double dx;
  double dy;
  double dz;
  int nx;
  int ny;
  int nz;
  double _xi_cube_[8][3];
  __Pyx_memviewslice xi_cube;
  double _xia_[3];
  __Pyx_memviewslice xia;
  double _xi_ref_[3];
  __Pyx_memviewslice xi_ref;
  int ind_x;
  int ind_xp1;
  int ind_y;
  int ind_yp1;
  int ind_z;
  int ind_zp1;
  double _ret_[3];
  __Pyx_memviewslice ret;
  double x_internal;
  double y_internal;
  double z_internal;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator {
  struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix __pyx_base;
  void (*_compute_indcs_and_wts_)(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *, double *, double *, double *);
  void (*_set_crnr_vcs_)(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *);
  void (*_compute_nrmd_wtd_sum_)(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *, double, double, double, __Pyx_memviewslice &amp;);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_vtabptr_33straininterpolationandintegration_LinearSpecialInterpolator;

</pre><pre class="cython line score-0">&#xA0;<span class="">0143</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>: <span class="sd">    A Cython extension type which facilitates linear interpolation of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: <span class="sd">    (stationary) vector fields in R^3, with a local orientation fix in order</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>: <span class="sd">    to combat orientational discontinuities, with normalized results.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>: <span class="sd">    Periodic boundary conditions are assumed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: <span class="sd">    Methods defined here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>: <span class="sd">    LinearSpecialInterpolator.__init__(x,y,z,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>: <span class="sd">    LinearSpecialInterpolator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: <span class="sd">    Version: 0.3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:         <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>:         <span class="n">double</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>:         <span class="n">double</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>:         <span class="nb">int</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>:         <span class="n">double</span> <span class="n">_xi_cube_</span><span class="p">[</span><span class="mf">8</span><span class="p">][</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>:         <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_cube</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:         <span class="n">double</span> <span class="n">_xia_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xia</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>:         <span class="n">double</span> <span class="n">_xi_ref_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_ref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>:         <span class="nb">int</span> <span class="n">ind_x</span><span class="p">,</span> <span class="n">ind_xp1</span><span class="p">,</span> <span class="n">ind_y</span><span class="p">,</span> <span class="n">ind_yp1</span><span class="p">,</span> <span class="n">ind_z</span><span class="p">,</span> <span class="n">ind_zp1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>:         <span class="n">double</span> <span class="n">_ret_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">ret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:         <span class="n">double</span> <span class="n">x_internal</span><span class="p">,</span> <span class="n">y_internal</span><span class="p">,</span> <span class="n">z_internal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator___cinit__(((struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator___cinit__(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.LinearSpecialInterpolator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xia</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xia_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_xia_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 173, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = __pyx_array_new(__pyx_t_3, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xia, 0);
  __pyx_v_self-&gt;xia = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xi_ref_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_xi_ref_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 174, __pyx_L1_error)</span>
  }
  __pyx_t_3 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_3 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_3))) <span class='error_goto'>__PYX_ERR(1, 174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_3), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 174, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi_ref, 0);
  __pyx_v_self-&gt;xi_ref = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xi_cube_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_6 = __pyx_v_self-&gt;_xi_cube_;
  if (!__pyx_t_6) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 175, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)8), ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = __pyx_array_new(__pyx_t_3, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "c", (char *) __pyx_t_6);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi_cube, 0);
  __pyx_v_self-&gt;xi_cube = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ret_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_ret_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 176, __pyx_L1_error)</span>
  }
  __pyx_t_3 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_3 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_3))) <span class='error_goto'>__PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_3), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ret, 0);
  __pyx_v_self-&gt;ret = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">y</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-67 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_25LinearSpecialInterpolator_2__init__[] = "\n        LinearSpecialInterpolator.__init__(x,y,z,xi)\n\n        Constructor for a LinearSpecialInterpolator instance.\n\n        Parameters\n        ----------\n        x : (nx,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (nx,),\n           containing the sampling points along the x abscissa.\n           Must be strictly increasing.\n        y : (ny,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (ny,),\n           containing the sampling points along the y abscissa.\n           Must be strictly increasing.\n        z : (nz,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (nz,),\n           containing the sampling points along the z abscissa.\n           Must be strictly increasing.\n        xi : (nx,ny,nz,3) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape\n           (nx,ny,nz,3), containing the sampled vector field.\n           xi[i,j,k] should correspond to the sample at (x[i],y[j],z[k]).\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_25LinearSpecialInterpolator_2__init__;
#endif
static int __pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_z,&amp;__pyx_n_s_xi,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xi)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_x = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(1, 181, __pyx_L3_error)</span>
    __pyx_v_y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(1, 181, __pyx_L3_error)</span>
    __pyx_v_z = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 182, __pyx_L3_error)</span>
    __pyx_v_xi = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_d_dc_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xi.memview)) __PYX_ERR(1, 182, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.LinearSpecialInterpolator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_x.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "x"); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_y.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "y"); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_z.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "z"); <span class='error_goto'>__PYX_ERR(1, 182, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_xi.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "xi"); <span class='error_goto'>__PYX_ERR(1, 182, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_2__init__(((struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_xi);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_2__init__(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_z, __Pyx_memviewslice __pyx_v_xi) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.LinearSpecialInterpolator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0182</span>:                        <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">z</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0183</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>: <span class="sd">        LinearSpecialInterpolator.__init__(x,y,z,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0186</span>: <span class="sd">        Constructor for a LinearSpecialInterpolator instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0188</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0189</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0190</span>: <span class="sd">        x : (nx,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0191</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (nx,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: <span class="sd">           containing the sampling points along the x abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>: <span class="sd">        y : (ny,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (ny,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: <span class="sd">           containing the sampling points along the y abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: <span class="sd">        z : (nz,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (nz,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: <span class="sd">           containing the sampling points along the z abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: <span class="sd">        xi : (nx,ny,nz,3) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0204</span>: <span class="sd">           (nx,ny,nz,3), containing the sampled vector field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>: <span class="sd">           xi[i,j,k] should correspond to the sample at (x[i],y[j],z[k]).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_xi.shape[0]) != (__pyx_v_x.shape[0])) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_xi.shape[1]) != (__pyx_v_y.shape[0])) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_xi.shape[2]) != (__pyx_v_z.shape[0])) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0209</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Array dimensions not aligned!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 209, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 209, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Array_dimensions_not_aligned);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 209, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>:         <span class="k">if</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_xi.shape[3]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolator routine is custom-built for three-dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 212, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_The_interpolator_routine_is_cust);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(1, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0">&#xA0;<span class="">0213</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>:         <span class="c"># Enforcing periodic BC by not including the sampling points along the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>:         <span class="c"># last rows and columns:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;nx = ((__pyx_v_x.shape[0]) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ny = ((__pyx_v_y.shape[0]) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;nz = ((__pyx_v_z.shape[0]) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_max</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_4)) )));
  __pyx_t_6 = (__pyx_v_self-&gt;nx - 1);
  __pyx_t_7 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_6)) )));
  __pyx_v_self-&gt;x_min = __pyx_t_5;
  __pyx_v_self-&gt;x_max = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0221</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_t_7 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_8)) )));
  __pyx_t_9 = (__pyx_v_self-&gt;ny - 1);
  __pyx_t_5 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_9)) )));
  __pyx_v_self-&gt;y_min = __pyx_t_7;
  __pyx_v_self-&gt;y_max = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">z_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_max</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 0;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_10)) )));
  __pyx_t_11 = (__pyx_v_self-&gt;nz - 1);
  __pyx_t_7 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_11)) )));
  __pyx_v_self-&gt;z_min = __pyx_t_5;
  __pyx_v_self-&gt;z_max = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">0223</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = 1;
  __pyx_t_13 = 0;
  __pyx_v_self-&gt;dx = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_12)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_13)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = 1;
  __pyx_t_15 = 0;
  __pyx_v_self-&gt;dy = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_14)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_15)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = 1;
  __pyx_t_17 = 0;
  __pyx_v_self-&gt;dz = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_16)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_17)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0227</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18.data = __pyx_v_xi.data;
  __pyx_t_18.memview = __pyx_v_xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 0);
  __pyx_t_19 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_xi.shape[0], __pyx_v_xi.strides[0], __pyx_v_xi.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_19,
    0,
    __pyx_v_self-&gt;nx,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 228, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_xi.shape[1], __pyx_v_xi.strides[1], __pyx_v_xi.suboffsets[1],
    1,
    1,
    &amp;__pyx_t_19,
    0,
    __pyx_v_self-&gt;ny,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 228, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_xi.shape[2], __pyx_v_xi.strides[2], __pyx_v_xi.suboffsets[2],
    2,
    2,
    &amp;__pyx_t_19,
    0,
    __pyx_v_self-&gt;nz,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 228, __pyx_L1_error)</span>
}

__pyx_t_18.shape[3] = __pyx_v_xi.shape[3];
__pyx_t_18.strides[3] = __pyx_v_xi.strides[3];
    __pyx_t_18.suboffsets[3] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi, 0);
  __pyx_v_self-&gt;xi = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0233</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_25LinearSpecialInterpolator_4__call__[] = "\n        LinearSpecialInterpolator.__call__(pos)\n\n        Evaluates the linearly interpolated vector field with orientation\n        fix, at the coordinates specified by pos.\n\n        Parameters\n        ----------\n        pos : (3,) array-like\n           A (C-contiguous) NumPy array containing the (Cartesian) coordinates\n           of the point in R^3 at which the vector field is to be interpolated.\n\n        Returns\n        -------\n        xi : (3,) array-like\n           A (C-contiguous) NumPy array containing the normalized, interpolated\n           vector.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_25LinearSpecialInterpolator_4__call__;
#endif
static PyObject *__pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 233, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(1, 233, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 233, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.LinearSpecialInterpolator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_pos.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "pos"); <span class='error_goto'>__PYX_ERR(1, 233, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_4__call__(((struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self), __pyx_v_pos);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_4__call__(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.LinearSpecialInterpolator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0234</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>: <span class="sd">        LinearSpecialInterpolator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="sd">        Evaluates the linearly interpolated vector field with orientation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: <span class="sd">        fix, at the coordinates specified by pos.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: <span class="sd">           A (C-contiguous) NumPy array containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: <span class="sd">           of the point in R^3 at which the vector field is to be interpolated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>: <span class="sd">        xi : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>: <span class="sd">           A (C-contiguous) NumPy array containing the normalized, interpolated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>:         <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_pos.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolation routine is custom-built&#39;</span>\</pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 254, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 254, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:                     <span class="o">+</span><span class="s">&#39; for three-dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_The_interpolation_routine_is_cus, __pyx_kp_s_for_three_dimensional_data);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 255, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_xi_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._interpolate_xi_(((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self), __pyx_v_pos, __pyx_v_self-&gt;ret);
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;ret, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0258</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0263</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_interpolate_xi_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">xi</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_25LinearSpecialInterpolator__interpolate_xi_(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice &amp;__pyx_v_xi) {
  double __pyx_v_x;
  double __pyx_v_y;
  double __pyx_v_z;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interpolate_xi_", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0264</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>: <span class="sd">        LinearSpecialInterpolator._interpolate_xi_(pos,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0266</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>: <span class="sd">        The C-level function which performs the special interpolation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0269</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0271</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: <span class="sd">           A (C-contiguous) NumPy array containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>: <span class="sd">           of the point in R^3 at which the vector field is to be interpolated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>: <span class="sd">        xi : (3,) array-like, intent = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: <span class="sd">           A (C-contiguous) NumPy array containing the normalized, interpolated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0280</span>:             <span class="n">double</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_internal</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_internal</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_internal</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;x_internal;
  __pyx_v_x = __pyx_t_1;
  __pyx_t_1 = __pyx_v_self-&gt;y_internal;
  __pyx_v_y = __pyx_t_1;
  __pyx_t_1 = __pyx_v_self-&gt;z_internal;
  __pyx_v_z = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0281</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         <span class="n">x</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_v_x = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_2)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 1;
  __pyx_v_y = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_3)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:         <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 2;
  __pyx_v_z = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_4)) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0285</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_compute_indcs_and_wts_</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="o">&amp;</span><span class="n">y</span><span class="p">,</span><span class="o">&amp;</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_compute_indcs_and_wts_(__pyx_v_self, (&amp;__pyx_v_x), (&amp;__pyx_v_y), (&amp;__pyx_v_z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_set_crnr_vcs_</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_set_crnr_vcs_(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_compute_nrmd_wtd_sum_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_compute_nrmd_wtd_sum_(__pyx_v_self, __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_xi);
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_compute_indcs_and_wts_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">z</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_25LinearSpecialInterpolator__compute_indcs_and_wts_(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self, double *__pyx_v_x, double *__pyx_v_y, double *__pyx_v_z) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_indcs_and_wts_", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0297</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>: <span class="sd">        LinearSpecialInterpolator._compute_indcs_and_wts_(x,y,z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0300</span>: <span class="sd">        The C-level function which determines the interpolation voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0301</span>: <span class="sd">        and weights along each abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: <span class="sd">        x : double, intent = inout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: <span class="sd">           On entry, the x-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: <span class="sd">           On exit, the (normalized) interpolation weight along the x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: <span class="sd">           abscissa within the interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: <span class="sd">        y : double, intent = inout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: <span class="sd">           On entry, the y-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: <span class="sd">           On exit, the (normalized) interpolation weight along the y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: <span class="sd">           abscissa within the interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: <span class="sd">        z : double, intent = inout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: <span class="sd">           On entry, the z-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: <span class="sd">           On exit, the (normalized) interpolation weight along the z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>: <span class="sd">           abscissa within the interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:         <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_min</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_x[0]) = fmod((((__pyx_v_x[0]) - __pyx_v_self-&gt;x_min) / __pyx_v_self-&gt;dx), __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:         <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_y[0]) = fmod((((__pyx_v_y[0]) - __pyx_v_self-&gt;y_min) / __pyx_v_self-&gt;dy), __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z_min</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_z[0]) = fmod((((__pyx_v_z[0]) - __pyx_v_self-&gt;z_min) / __pyx_v_self-&gt;dz), __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:         <span class="k">while</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (((__pyx_v_x[0]) &lt; 0.0) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:             <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = 0;
    (__pyx_v_x[__pyx_t_2]) = ((__pyx_v_x[__pyx_t_2]) + __pyx_v_self-&gt;nx);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0326</span>:         <span class="k">while</span> <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (((__pyx_v_y[0]) &lt; 0.0) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0327</span>:             <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = 0;
    (__pyx_v_y[__pyx_t_2]) = ((__pyx_v_y[__pyx_t_2]) + __pyx_v_self-&gt;ny);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0328</span>:         <span class="k">while</span> <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (((__pyx_v_z[0]) &lt; 0.0) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0329</span>:             <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = 0;
    (__pyx_v_z[__pyx_t_2]) = ((__pyx_v_z[__pyx_t_2]) + __pyx_v_self-&gt;nz);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0330</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0331</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_x = ((int)floor((__pyx_v_x[0])));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0332</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_y = ((int)floor((__pyx_v_y[0])));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0333</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_z = ((int)floor((__pyx_v_z[0])));
</pre><pre class="cython line score-0">&#xA0;<span class="">0334</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0335</span>:         <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  (__pyx_v_x[__pyx_t_2]) = ((__pyx_v_x[__pyx_t_2]) - __pyx_v_self-&gt;ind_x);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0336</span>:         <span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  (__pyx_v_y[__pyx_t_2]) = ((__pyx_v_y[__pyx_t_2]) - __pyx_v_self-&gt;ind_y);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>:         <span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  (__pyx_v_z[__pyx_t_2]) = ((__pyx_v_z[__pyx_t_2]) - __pyx_v_self-&gt;ind_z);
</pre><pre class="cython line score-0">&#xA0;<span class="">0338</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0339</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_xp1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_xp1 = ((int)((__pyx_v_self-&gt;ind_x + 1) % __pyx_v_self-&gt;nx));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_yp1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_yp1 = ((int)((__pyx_v_self-&gt;ind_y + 1) % __pyx_v_self-&gt;ny));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ind_zp1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ind_zp1 = ((int)((__pyx_v_self-&gt;ind_z + 1) % __pyx_v_self-&gt;nz));
</pre><pre class="cython line score-0">&#xA0;<span class="">0342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_set_crnr_vcs_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_33straininterpolationandintegration_25LinearSpecialInterpolator__set_crnr_vcs_(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self) {
  __Pyx_memviewslice __pyx_v_xi_tmp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi_ref = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_set_crnr_vcs_", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("straininterpolationandintegration.LinearSpecialInterpolator._set_crnr_vcs_", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_ref, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_cube, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: <span class="sd">        LinearSpecialInterpolator._set_crnr_vcs_()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: <span class="sd">        The C-level function which identifies the vector values at the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>: <span class="sd">        corners of the interpolation voxel, generating local copies which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: <span class="sd">        are corrected for orientational discontinuities prior to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="sd">        linear interpolation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0358</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xia</span><span class="p">,</span> <span class="n">xi_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_ref</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;xia;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_xi_tmp = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;xi_ref;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_xi_ref = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:             <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;xi;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_v_xi = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>:             <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_cube</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;xi_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_xi_cube = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0361</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0362</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_xi.data;
  __pyx_t_1.memview = __pyx_v_xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_x;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 362, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_y;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 362, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_z;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 362, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_ref, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0363</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0364</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_xi.data;
  __pyx_t_1.memview = __pyx_v_xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_x;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 364, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_y;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 364, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_z;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 364, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0366</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0367</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 367, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0368</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_xp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_xp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 369, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_y;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 369, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_z;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 369, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0372</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 372, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0373</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_yp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_x;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 374, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_yp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 374, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_z;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 374, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 2;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 377, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0378</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_xp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_yp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_z</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_xp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 379, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_yp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 379, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_z;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 379, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0382</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 3;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 382, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0383</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_zp1</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_x;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_y;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_zp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">4</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 4;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 387, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0388</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_xp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_zp1</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_xp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 389, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_y;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 389, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_zp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 389, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 5;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 392, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0393</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_yp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_zp1</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_x;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 394, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_yp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 394, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_zp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 394, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 6;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 397, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0398</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0399</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_xp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_yp1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ind_zp1</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1.data = __pyx_v_self-&gt;xi.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_xp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 399, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_yp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 399, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_self-&gt;ind_zp1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;xi.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;xi.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 399, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;xi.shape[3];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;xi.strides[3];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_1, 1, __pyx_v_xi_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi_tmp, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0401</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_xi_tmp, 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">7</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1.data = __pyx_v_xi_cube.data;
  __pyx_t_1.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 7;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 402, __pyx_L1_error)</span>
    }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_1.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_xi_tmp, 1, __pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_compute_nrmd_wtd_sum_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="n">z</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">xi</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_33straininterpolationandintegration_25LinearSpecialInterpolator__compute_nrmd_wtd_sum_(struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self, double __pyx_v_x, double __pyx_v_y, double __pyx_v_z, __Pyx_memviewslice &amp;__pyx_v_xi) {
  __Pyx_memviewslice __pyx_v_xi_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_nrmd_wtd_sum_", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("straininterpolationandintegration.LinearSpecialInterpolator._compute_nrmd_wtd_sum_", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_cube, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">        LinearSpecialInterpolator._compute_nrmd_wtd_sum_(x,y,z,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span class="sd">        The C-level function which computes the normalized, weighted sum</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">        which generates the interpolated vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: <span class="sd">        x : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="sd">           The (normalized) interpolation weight along the x abscissa within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="sd">           interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="sd">        y : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="sd">           The (normalized) interpolation weight along the y abscissa within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>: <span class="sd">           interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>: <span class="sd">        z : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: <span class="sd">           The (normalized) interpolation weight along the z abscissa within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>: <span class="sd">           interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: <span class="sd">        xi : (3,) memoryview, intent = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: <span class="sd">            On exit, the normalized, linearly interpolated vector, as a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>: <span class="sd">            (C-contiguous) memoryview of doubles.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0431</span>:             <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_cube</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;xi_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_xi_cube = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0432</span>:         <span class="c"># LC along z-axis</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0433</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 433, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_z), __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">4</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 4;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 434, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 434, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_z, __pyx_t_2, 1, __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 436, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_z), __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 5;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 437, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 437, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_z, __pyx_t_3, 1, __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0438</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0439</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 2;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 439, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_z), __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 6;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 440, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 2;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 440, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_z, __pyx_t_2, 1, __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0441</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0442</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 3;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 442, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_z), __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0443</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">7</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 7;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 443, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 3;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 443, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_z, __pyx_t_3, 1, __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0444</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>:         <span class="c"># LC along y-axis</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 446, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_y), __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0447</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 2;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 447, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 447, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_y, __pyx_t_2, 1, __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0448</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 449, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_y), __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 3;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 450, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 450, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_y, __pyx_t_3, 1, __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0451</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0452</span>:         <span class="c"># LC along x-axis</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 453, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dscal(3, (1.0 - __pyx_v_x), __pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2.data = __pyx_v_xi_cube.data;
  __pyx_t_2.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 1;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 454, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_2.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 454, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_daxpy(3, __pyx_v_x, __pyx_t_2, 1, __pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0455</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:         <span class="c"># Assign to output</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0457</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3.data = __pyx_v_xi_cube.data;
  __pyx_t_3.memview = __pyx_v_xi_cube.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_cube.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_cube.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 457, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_cube.shape[1];
__pyx_t_3.strides[0] = __pyx_v_xi_cube.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_3, 1, __pyx_v_xi, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>:         <span class="c"># Normalize output</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:         <span class="n">_cy_normalize_</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration__cy_normalize_(__pyx_v_xi);
</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0462</span>:     <span class="k">def</span> <span class="nf">__dealoc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_7__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_25LinearSpecialInterpolator_7__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__ (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_6__dealoc__(((struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_25LinearSpecialInterpolator_6__dealoc__(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_LinearSpecialInterpolator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0463</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0465</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">CubicSpecialInterpolator</span><span class="p">(</span><span class="n">InterpolatorWithOrientationFix</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator {
  struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix __pyx_base;
  ItpCont *itpx;
  ItpCont *itpy;
  ItpCont *itpz;
  __Pyx_memviewslice xi_grid;
  __Pyx_memviewslice x_grid;
  __Pyx_memviewslice y_grid;
  __Pyx_memviewslice z_grid;
  double dx;
  double dy;
  double dz;
  int nx;
  int ny;
  int nz;
  double _x_cube_[4];
  double _y_cube_[4];
  double _z_cube_[4];
  __Pyx_memviewslice x_cube;
  __Pyx_memviewslice y_cube;
  __Pyx_memviewslice z_cube;
  int _inds_x_[4];
  int _inds_y_[4];
  int _inds_z_[4];
  __Pyx_memviewslice inds_x;
  __Pyx_memviewslice inds_y;
  __Pyx_memviewslice inds_z;
  double _xi_cube_[3][64];
  __Pyx_memviewslice xi_cube;
  double _xival_[3];
  __Pyx_memviewslice xival;
  double _tmp_[3];
  __Pyx_memviewslice tmp;
  double _xi_ref_[3];
  __Pyx_memviewslice xi_ref;
  double _ret_[3];
  __Pyx_memviewslice ret;
  int calibrated;
  int sameaslast;
  int kx;
  int ky;
  int kz;
  double x_internal;
  double y_internal;
  double z_internal;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_CubicSpecialInterpolator {
  struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix __pyx_base;
  void (*_set_voxel_indices_)(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *, double, double, double);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_vtabptr_33straininterpolationandintegration_CubicSpecialInterpolator;

</pre><pre class="cython line score-0">&#xA0;<span class="">0466</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: <span class="sd">    A Cython extension type which facilitates cubic B-spline interpolation of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: <span class="sd">    (stationary) vector fields in R^3, with a local orientation fix in order</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: <span class="sd">    to combat orientational discontinuities, with normalized results.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>: <span class="sd">    Periodic boundary conditions are assumed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>: <span class="sd">    NOTE: In order for this to function as intended (allowing for cubic</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0473</span>: <span class="sd">          polylomial pieces, corresponding to a quartic spline), the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: <span class="sd">          bspline-fortran source code must be slightly modified.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>: <span class="sd">          In particular, in the subroutine &#39;check_k&#39;, which is located withihn</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>: <span class="sd">          bspline_sub_module.f90, the second condition of the if statement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>: <span class="sd">          must be changed from &#39;k &gt;= n&#39; to &#39;k &gt; n&#39;.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>: <span class="sd">    Methods defined here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>: <span class="sd">    CubicSpecialInterpolator.__init__(x,y,z,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>: <span class="sd">    CubicSpecialInterpolator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0482</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: <span class="sd">    Version: 0.3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>:         <span class="n">ItpCont</span> <span class="o">*</span><span class="n">itpx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:         <span class="n">ItpCont</span> <span class="o">*</span><span class="n">itpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>:         <span class="n">ItpCont</span> <span class="o">*</span><span class="n">itpz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>:         <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_grid</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span><span class="p">,</span> <span class="n">z_grid</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>:         <span class="n">double</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:         <span class="nb">int</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:         <span class="n">double</span> <span class="n">_x_cube_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:         <span class="n">double</span> <span class="n">_y_cube_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:         <span class="n">double</span> <span class="n">_z_cube_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x_cube</span><span class="p">,</span> <span class="n">y_cube</span><span class="p">,</span> <span class="n">z_cube</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:         <span class="nb">int</span> <span class="n">_inds_x_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>:         <span class="nb">int</span> <span class="n">_inds_y_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>:         <span class="nb">int</span> <span class="n">_inds_z_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>:         <span class="nb">int</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">inds_x</span><span class="p">,</span> <span class="n">inds_y</span><span class="p">,</span> <span class="n">inds_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>:         <span class="n">double</span> <span class="n">_xi_cube_</span><span class="p">[</span><span class="mf">3</span><span class="p">][</span><span class="mf">64</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:         <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_cube</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>:         <span class="n">double</span> <span class="n">_xival_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xival</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>:         <span class="n">double</span> <span class="n">_tmp_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">tmp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>:         <span class="n">double</span> <span class="n">_xi_ref_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_ref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>:         <span class="n">double</span> <span class="n">_ret_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">ret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>:         <span class="n">bint</span> <span class="n">calibrated</span><span class="p">,</span> <span class="n">sameaslast</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>:         <span class="nb">int</span> <span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">kz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>:         <span class="n">double</span> <span class="n">x_internal</span><span class="p">,</span> <span class="n">y_internal</span><span class="p">,</span> <span class="n">z_internal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator___cinit__(((struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator___cinit__(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.CubicSpecialInterpolator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0517</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">itpx</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ItpCont</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = new ItpCont();
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 517, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;itpx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0518</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">itpy</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ItpCont</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = new ItpCont();
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 518, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;itpy = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0519</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">itpz</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ItpCont</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_1 = new ItpCont();
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 519, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;itpz = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0520</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_cube_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_x_cube_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 520, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_5 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_5))) <span class='error_goto'>__PYX_ERR(1, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_5), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 520, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;x_cube, 0);
  __pyx_v_self-&gt;x_cube = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_cube_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_y_cube_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 521, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_4 || !__pyx_t_5 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = __pyx_array_new(__pyx_t_5, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 521, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;y_cube, 0);
  __pyx_v_self-&gt;y_cube = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0522</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">z_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z_cube_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_z_cube_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 522, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_5 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_5))) <span class='error_goto'>__PYX_ERR(1, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_5), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 522, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;z_cube, 0);
  __pyx_v_self-&gt;z_cube = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0523</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">inds_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inds_x_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_7 = __pyx_v_self-&gt;_inds_x_;
  if (!__pyx_t_7) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 523, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_int);
  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_4 || !__pyx_t_5 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = __pyx_array_new(__pyx_t_5, sizeof(int), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_7);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_int</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 523, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;inds_x, 0);
  __pyx_v_self-&gt;inds_x = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">inds_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inds_y_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_7 = __pyx_v_self-&gt;_inds_y_;
  if (!__pyx_t_7) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 524, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_int);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_5 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_5))) <span class='error_goto'>__PYX_ERR(1, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = __pyx_array_new(__pyx_t_4, sizeof(int), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_5), (char *) "fortran", (char *) __pyx_t_7);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_int</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 524, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;inds_y, 0);
  __pyx_v_self-&gt;inds_y = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">inds_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inds_z_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_7 = __pyx_v_self-&gt;_inds_z_;
  if (!__pyx_t_7) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 525, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_int);
  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_4 || !__pyx_t_5 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = __pyx_array_new(__pyx_t_5, sizeof(int), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_7);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_int</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(1, 525, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;inds_z, 0);
  __pyx_v_self-&gt;inds_z = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xi_cube_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_9 = __pyx_v_self-&gt;_xi_cube_;
  if (!__pyx_t_9) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 526, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3), ((Py_ssize_t)64));
  if (unlikely(!__pyx_t_5 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_5))) <span class='error_goto'>__PYX_ERR(1, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_5), (char *) "c", (char *) __pyx_t_9);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(1, 526, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi_cube, 0);
  __pyx_v_self-&gt;xi_cube = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_tmp_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 527, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_5 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = __pyx_array_new(__pyx_t_5, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 527, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;tmp, 0);
  __pyx_v_self-&gt;tmp = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xi_ref_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_xi_ref_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 528, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_5 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_5))) <span class='error_goto'>__PYX_ERR(1, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_5), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 528, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi_ref, 0);
  __pyx_v_self-&gt;xi_ref = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">calibrated</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;calibrated = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ret_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = __pyx_v_self-&gt;_ret_;
  if (!__pyx_t_2) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 530, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_5 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = __pyx_array_new(__pyx_t_5, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_2);
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(1, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_3), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(1, 530, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ret, 0);
  __pyx_v_self-&gt;ret = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sameaslast</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;sameaslast = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0536</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">y</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">z</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> \</pre>
<pre class='cython code score-100 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24CubicSpecialInterpolator_2__init__[] = "\n        CubicSpecialInterpolator.__init__(x,y,z,xi)\n\n        Constructor for a CubicSpecialInterpolator instance.\n\n        Parameters\n        ----------\n        x : (nx,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (nx,),\n           containing the sampling points along the x abscissa.\n           Must be strictly increasing.\n        y : (ny,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (ny,),\n           containing the sampling points along the y abscissa.\n           Must be strictly increasing.\n        z : (nz,) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape (nz,),\n           containing the sampling points along the z abscissa.\n           Must be strictly increasing.\n        xi : (nx,ny,nz,3) array-like\n           A (C-contiguous) NumPy array of type np.float64 and shape\n           (nx,ny,nz,3), containing the sampled vector field.\n           xi[i,j,k] should correspond to the sample at (x[i],y[j],z[k]).\n        kx : integer, optional\n           Spline order along the x abscissa. Default: kx = 4\n        ky : integer, optional\n           Spline order along the y abscissa. Default: ky = 4\n        kz : integer, optional\n           Spline order along the z abscissa. Default: kz = 4\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_24CubicSpecialInterpolator_2__init__;
#endif
static int __pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_kx;
  int __pyx_v_ky;
  int __pyx_v_kz;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_z,&amp;__pyx_n_s_xi,&amp;__pyx_n_s_kx,&amp;__pyx_n_s_ky,&amp;__pyx_n_s_kz,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 7, 1); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 7, 2); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xi)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 7, 3); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kx);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ky);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kz);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_x = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(1, 536, __pyx_L3_error)</span>
    __pyx_v_y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(1, 536, __pyx_L3_error)</span>
    __pyx_v_z = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_z.memview)) __PYX_ERR(1, 536, __pyx_L3_error)</span>
    __pyx_v_xi = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_d_dc_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xi.memview)) __PYX_ERR(1, 537, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_kx = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_kx == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 537, __pyx_L3_error)</span>
    } else {
      __pyx_v_kx = ((int)4);
    }
    if (values[5]) {
      __pyx_v_ky = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_ky == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 537, __pyx_L3_error)</span>
    } else {
      __pyx_v_ky = ((int)4);
    }
    if (values[6]) {
      __pyx_v_kz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_kz == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 537, __pyx_L3_error)</span>
    } else {
      __pyx_v_kz = ((int)4);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 4, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.CubicSpecialInterpolator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_x.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "x"); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_y.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "y"); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_z.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "z"); <span class='error_goto'>__PYX_ERR(1, 536, __pyx_L1_error)</span>
  }
  if (unlikely(((PyObject *)__pyx_v_xi.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "xi"); <span class='error_goto'>__PYX_ERR(1, 537, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_2__init__(((struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_z, __pyx_v_xi, __pyx_v_kx, __pyx_v_ky, __pyx_v_kz);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_2__init__(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_z, __Pyx_memviewslice __pyx_v_xi, int __pyx_v_kx, int __pyx_v_ky, int __pyx_v_kz) {
  int __pyx_v_i;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.CubicSpecialInterpolator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0537</span>:             <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kx</span> <span class="o">=</span> <span class="mf">4</span><span class="p">,</span> <span class="nb">int</span> <span class="n">ky</span> <span class="o">=</span> <span class="mf">4</span><span class="p">,</span> <span class="nb">int</span> <span class="n">kz</span> <span class="o">=</span> <span class="mf">4</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">        CubicSpecialInterpolator.__init__(x,y,z,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">        Constructor for a CubicSpecialInterpolator instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">        x : (nx,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (nx,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>: <span class="sd">           containing the sampling points along the x abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: <span class="sd">        y : (ny,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (ny,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: <span class="sd">           containing the sampling points along the y abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>: <span class="sd">        z : (nz,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape (nz,),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>: <span class="sd">           containing the sampling points along the z abscissa.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>: <span class="sd">           Must be strictly increasing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>: <span class="sd">        xi : (nx,ny,nz,3) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>: <span class="sd">           A (C-contiguous) NumPy array of type np.float64 and shape</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>: <span class="sd">           (nx,ny,nz,3), containing the sampled vector field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>: <span class="sd">           xi[i,j,k] should correspond to the sample at (x[i],y[j],z[k]).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: <span class="sd">        kx : integer, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>: <span class="sd">           Spline order along the x abscissa. Default: kx = 4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: <span class="sd">        ky : integer, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: <span class="sd">           Spline order along the y abscissa. Default: ky = 4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>: <span class="sd">        kz : integer, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>: <span class="sd">           Spline order along the z abscissa. Default: kz = 4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>:             <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:         <span class="k">if</span><span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_xi.shape[0]) != (__pyx_v_x.shape[0])) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_xi.shape[1]) != (__pyx_v_y.shape[0])) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_xi.shape[2]) != (__pyx_v_z.shape[0])) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Array dimensions not aligned!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 572, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Array_dimensions_not_aligned);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(1, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4</span> <span class="ow">or</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4</span> <span class="ow">or</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_x.shape[0]) &lt; 4) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_y.shape[0]) &lt; 4) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_2 = (((__pyx_v_z.shape[0]) &lt; 4) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L8_bool_binop_done:;
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0574</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Insufficient amount of data points to perform cubic interpolation!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 574, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 574, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Insufficient_amount_of_data_poin);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:         <span class="k">if</span><span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_xi.shape[3]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolator routine is custom-built for three dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 576, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_The_interpolator_routine_is_cust_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(1, 576, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0578</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">kx</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="ow">or</span> <span class="n">kx</span> <span class="o">&gt;</span> <span class="mf">4</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ky</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="ow">or</span> <span class="n">ky</span> <span class="o">&gt;</span> <span class="mf">4</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">kz</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="ow">or</span> <span class="n">kz</span> <span class="o">&gt;</span> <span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_kx &lt; 2) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_kx &gt; 4) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_ky &lt; 2) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_ky &gt; 4) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_kz &lt; 2) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_kz &gt; 4) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L13_bool_binop_done:;
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0579</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Invalid choice of interpolator order!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 579, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Invalid_choice_of_interpolator_o);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(1, 579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0">&#xA0;<span class="">0580</span>:         <span class="c"># Enforcing periodic BC by not including the sampling points along</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>:         <span class="c"># the last rows and columns</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0582</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;nx = ((__pyx_v_x.shape[0]) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0583</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ny = ((__pyx_v_y.shape[0]) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0584</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;nz = ((__pyx_v_z.shape[0]) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0585</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0586</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4.data = __pyx_v_x.data;
  __pyx_t_4.memview = __pyx_v_x.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  __pyx_t_5 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_4,
    __pyx_v_x.shape[0], __pyx_v_x.strides[0], __pyx_v_x.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;nx,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 586, __pyx_L1_error)</span>
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;x_grid, 0);
  __pyx_v_self-&gt;x_grid = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0587</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4.data = __pyx_v_y.data;
  __pyx_t_4.memview = __pyx_v_y.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  __pyx_t_5 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_4,
    __pyx_v_y.shape[0], __pyx_v_y.strides[0], __pyx_v_y.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;ny,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 587, __pyx_L1_error)</span>
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;y_grid, 0);
  __pyx_v_self-&gt;y_grid = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0588</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4.data = __pyx_v_z.data;
  __pyx_t_4.memview = __pyx_v_z.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  __pyx_t_5 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_4,
    __pyx_v_z.shape[0], __pyx_v_z.strides[0], __pyx_v_z.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;nz,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 588, __pyx_L1_error)</span>
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;z_grid, 0);
  __pyx_v_self-&gt;z_grid = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0589</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0590</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 1;
  __pyx_t_7 = 0;
  __pyx_v_self-&gt;dx = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_6)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_7)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0591</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 1;
  __pyx_t_9 = 0;
  __pyx_v_self-&gt;dy = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_8)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_9)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0592</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 1;
  __pyx_t_11 = 0;
  __pyx_v_self-&gt;dz = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_10)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_11)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0593</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>:         <span class="c"># Set local coordinates for interpolation within any given 4x4x4 voxel</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0595</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_5 = 0; __pyx_t_5 &lt; 4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">x_cube</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_cube.data) + __pyx_t_12)) )) = ((__pyx_v_i - 1) * __pyx_v_self-&gt;dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0597</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">y_cube</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_cube.data) + __pyx_t_13)) )) = ((__pyx_v_i - 1) * __pyx_v_self-&gt;dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">z_cube</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_i;
    *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_cube.data) + __pyx_t_14)) )) = ((__pyx_v_i - 1) * __pyx_v_self-&gt;dz);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0599</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0600</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_grid</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,:</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,:</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,:]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15.data = __pyx_v_xi.data;
  __pyx_t_15.memview = __pyx_v_xi.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 0);
  __pyx_t_5 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_xi.shape[0], __pyx_v_xi.strides[0], __pyx_v_xi.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;nx,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 600, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_xi.shape[1], __pyx_v_xi.strides[1], __pyx_v_xi.suboffsets[1],
    1,
    1,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;ny,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 600, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_xi.shape[2], __pyx_v_xi.strides[2], __pyx_v_xi.suboffsets[2],
    2,
    2,
    &amp;__pyx_t_5,
    0,
    __pyx_v_self-&gt;nz,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 600, __pyx_L1_error)</span>
}

__pyx_t_15.shape[3] = __pyx_v_xi.shape[3];
__pyx_t_15.strides[3] = __pyx_v_xi.strides[3];
    __pyx_t_15.suboffsets[3] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi_grid, 0);
  __pyx_v_self-&gt;xi_grid = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0601</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">kx</span> <span class="o">=</span> <span class="n">kx</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;kx = __pyx_v_kx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ky</span> <span class="o">=</span> <span class="n">ky</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ky = __pyx_v_ky;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">kz</span> <span class="o">=</span> <span class="n">kz</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;kz = __pyx_v_kz;
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24CubicSpecialInterpolator_4__call__[] = "\n        CubicSpecialInterpolator.__call__(pos)\n\n        Evaluates the B-spline interpolated vector field with orientation\n        fix, at the coordinates specified by pos.\n\n        Parameters\n        ----------\n        pos : (3,) array-like\n           A (C-contiguous) NumPy array containing the (Cartesian) coordinates\n           of the point in R^3 at which the vector field is to be interpolated.\n\n        Returns\n        -------\n        xi : (3,) array-like\n           A (C-contiguous) NumPy array containing the normalized, interpolated\n           vector.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_24CubicSpecialInterpolator_4__call__;
#endif
static PyObject *__pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_5__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 609, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(1, 609, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 609, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.CubicSpecialInterpolator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_pos.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "pos"); <span class='error_goto'>__PYX_ERR(1, 609, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_4__call__(((struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self), __pyx_v_pos);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_4__call__(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.CubicSpecialInterpolator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0610</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>: <span class="sd">        CubicSpecialInterpolator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: <span class="sd">        Evaluates the B-spline interpolated vector field with orientation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>: <span class="sd">        fix, at the coordinates specified by pos.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0617</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>: <span class="sd">           A (C-contiguous) NumPy array containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>: <span class="sd">           of the point in R^3 at which the vector field is to be interpolated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>: <span class="sd">        xi : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0625</span>: <span class="sd">           A (C-contiguous) NumPy array containing the normalized, interpolated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0626</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0628</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:         <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_pos.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolation routine is custom-built&#39;</span>\</pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 630, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:                     <span class="o">+</span><span class="s">&#39; for three dimensional data&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_The_interpolation_routine_is_cus, __pyx_kp_s_for_three_dimensional_data_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 631, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_xi_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._interpolate_xi_(((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self), __pyx_v_pos, __pyx_v_self-&gt;ret);
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;ret, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 633, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0634</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0637</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_interpolate_xi_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">xi</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_33straininterpolationandintegration_24CubicSpecialInterpolator__interpolate_xi_(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice &amp;__pyx_v_xi) {
  double __pyx_v_x;
  double __pyx_v_y;
  double __pyx_v_z;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_l;
  __Pyx_memviewslice __pyx_v_inds_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_inds_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_inds_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_x_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi_cube = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi_grid = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tmp_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xi_ref = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_interpolate_xi_", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("straininterpolationandintegration.CubicSpecialInterpolator._interpolate_xi_", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_z, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_cube, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y_cube, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z_cube, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_cube, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_grid, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tmp_xi, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi_ref, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>: <span class="sd">        CubicSpecialInterpolator._interpolate_xi_(pos,xi)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: <span class="sd">        The C-level function which performs the special interpolation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>: <span class="sd">           A (C-contiguous) NumPy array containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>: <span class="sd">           of the point in R^3 at which the vector field is to be interpolated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>: <span class="sd">        xi : (3,) array-like, intent = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>: <span class="sd">           A (C-contiguous) NumPy array containing the normalized, interpolated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:             <span class="n">double</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_internal</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_internal</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_internal</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;x_internal;
  __pyx_v_x = __pyx_t_1;
  __pyx_t_1 = __pyx_v_self-&gt;y_internal;
  __pyx_v_y = __pyx_t_1;
  __pyx_t_1 = __pyx_v_self-&gt;z_internal;
  __pyx_v_z = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0657</span>:             <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span><span class="n">l</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:             <span class="nb">int</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">inds_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_x</span><span class="p">,</span> <span class="n">inds_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_y</span><span class="p">,</span> <span class="n">inds_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_z</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;inds_x;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_v_inds_x = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_t_2 = __pyx_v_self-&gt;inds_y;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_v_inds_y = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_t_2 = __pyx_v_self-&gt;inds_z;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_v_inds_z = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0659</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_cube</span><span class="p">,</span> <span class="n">y_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_cube</span><span class="p">,</span> <span class="n">z_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_cube</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;x_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_x_cube = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __pyx_t_3 = __pyx_v_self-&gt;y_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_y_cube = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __pyx_t_3 = __pyx_v_self-&gt;z_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_z_cube = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:             <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_cube</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_cube</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;xi_cube;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_v_xi_cube = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:             <span class="n">double</span><span class="p">[:,:,:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi_grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_grid</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;xi_grid;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_v_xi_grid = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">tmp_xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">,</span> <span class="n">xi_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi_ref</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;tmp;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_tmp_xi = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __pyx_t_3 = __pyx_v_self-&gt;xi_ref;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_xi_ref = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:         <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 0;
  __pyx_t_1 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_6)) )));
  __pyx_t_7 = 1;
  __pyx_t_8 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_7)) )));
  __pyx_t_9 = 2;
  __pyx_t_10 = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pos.data) + __pyx_t_9)) )));
  __pyx_v_x = __pyx_t_1;
  __pyx_v_y = __pyx_t_8;
  __pyx_v_z = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:         <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_11 = 0;
    __pyx_t_12 = ((__pyx_v_x &lt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_11)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:             <span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = (__pyx_v_self-&gt;nx - 1);
    __pyx_t_14 = 0;
    __pyx_v_x = (__pyx_v_x + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_13)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_14)) )))));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>:         <span class="k">while</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_15 = 0;
    __pyx_t_12 = ((__pyx_v_y &lt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_15)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:             <span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = (__pyx_v_self-&gt;ny - 1);
    __pyx_t_17 = 0;
    __pyx_v_y = (__pyx_v_y + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_16)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_17)) )))));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:         <span class="k">while</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_18 = 0;
    __pyx_t_12 = ((__pyx_v_z &lt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_18)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:             <span class="n">z</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = (__pyx_v_self-&gt;nz - 1);
    __pyx_t_20 = 0;
    __pyx_v_z = (__pyx_v_z + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_19)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_20)) )))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0670</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:         <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_21 = (__pyx_v_self-&gt;nx - 1);
    __pyx_t_12 = ((__pyx_v_x &gt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_21)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0672</span>:             <span class="n">x</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = (__pyx_v_self-&gt;nx - 1);
    __pyx_t_23 = 0;
    __pyx_v_x = (__pyx_v_x - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_22)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_23)) )))));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:         <span class="k">while</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_24 = (__pyx_v_self-&gt;ny - 1);
    __pyx_t_12 = ((__pyx_v_y &gt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_24)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>:             <span class="n">y</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_25 = (__pyx_v_self-&gt;ny - 1);
    __pyx_t_26 = 0;
    __pyx_v_y = (__pyx_v_y - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_25)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_26)) )))));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0675</span>:         <span class="k">while</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="o">-</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_27 = (__pyx_v_self-&gt;nz - 1);
    __pyx_t_12 = ((__pyx_v_z &gt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_27)) )))) != 0);
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0676</span>:             <span class="n">z</span> <span class="o">-=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_t_28 = (__pyx_v_self-&gt;nz - 1);
    __pyx_t_29 = 0;
    __pyx_v_z = (__pyx_v_z - ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_28)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_29)) )))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0677</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_set_voxel_indices_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_set_voxel_indices_(__pyx_v_self, __pyx_v_x, __pyx_v_y, __pyx_v_z);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:         <span class="n">x</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="n">inds_x</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = 1;
  __pyx_t_31 = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_30)) )));
  __pyx_v_x = (__pyx_v_x - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_31)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:         <span class="n">y</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="n">inds_y</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_32 = 1;
  __pyx_t_33 = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_32)) )));
  __pyx_v_y = (__pyx_v_y - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_33)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>:         <span class="n">z</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="n">inds_z</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = 1;
  __pyx_t_35 = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_34)) )));
  __pyx_v_z = (__pyx_v_z - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_35)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0682</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sameaslast</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_36 = (__pyx_v_self-&gt;sameaslast != 0);
  if (__pyx_t_36) {
  } else {
    __pyx_t_12 = __pyx_t_36;
    goto __pyx_L16_bool_binop_done;
  }
  __pyx_t_36 = (__pyx_v_self-&gt;calibrated != 0);
  __pyx_t_12 = __pyx_t_36;
  __pyx_L16_bool_binop_done:;
  __pyx_t_36 = ((!__pyx_t_12) != 0);
  if (__pyx_t_36) {
/* … */
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:             <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_grid</span><span class="p">[</span><span class="n">inds_x</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">inds_y</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">inds_z</span><span class="p">[</span><span class="mf">0</span><span class="p">]],</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>    __pyx_t_37 = 0;
    __pyx_t_38 = 0;
    __pyx_t_39 = 0;
    __pyx_t_3.data = __pyx_v_xi_grid.data;
    __pyx_t_3.memview = __pyx_v_xi_grid.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
    {
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_37)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 683, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_38)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 683, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_39)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 683, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_grid.shape[3];
__pyx_t_3.strides[0] = __pyx_v_xi_grid.strides[3];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_3, 1, __pyx_v_xi_ref, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL;
    __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_40 = 0; __pyx_t_40 &lt; 4; __pyx_t_40+=1) {
      __pyx_v_k = __pyx_t_40;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_41 = 0; __pyx_t_41 &lt; 4; __pyx_t_41+=1) {
        __pyx_v_j = __pyx_t_41;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        for (__pyx_t_42 = 0; __pyx_t_42 &lt; 4; __pyx_t_42+=1) {
          __pyx_v_i = __pyx_t_42;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:                         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi_grid</span><span class="p">[</span><span class="n">inds_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">inds_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">inds_z</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span><span class="mf">1</span><span class="p">,</span><span class="n">tmp_xi</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>          __pyx_t_43 = __pyx_v_i;
          __pyx_t_44 = __pyx_v_j;
          __pyx_t_45 = __pyx_v_k;
          __pyx_t_3.data = __pyx_v_xi_grid.data;
          __pyx_t_3.memview = __pyx_v_xi_grid.memview;
          __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
          {
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_43)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 687, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_44)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>__PYX_ERR(1, 687, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_45)) )));
    Py_ssize_t __pyx_tmp_shape = __pyx_v_xi_grid.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xi_grid.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>__PYX_ERR(1, 687, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_xi_grid.shape[3];
__pyx_t_3.strides[0] = __pyx_v_xi_grid.strides[3];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_t_3, 1, __pyx_v_tmp_xi, 1);
          __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
          __pyx_t_3.memview = NULL;
          __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0688</span>:                         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">tmp_xi</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">xi_ref</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_36 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_tmp_xi, 1, __pyx_v_xi_ref, 1) &lt; 0.0) != 0);
          if (__pyx_t_36) {
/* … */
            goto __pyx_L24;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>:                             <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>            for (__pyx_t_46 = 0; __pyx_t_46 &lt; 3; __pyx_t_46+=1) {
              __pyx_v_l = __pyx_t_46;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:                                 <span class="n">xi_cube</span><span class="p">[</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mf">4</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mf">4</span><span class="o">*</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">tmp_xi</span><span class="p">[</span><span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_t_47 = __pyx_v_l;
              __pyx_t_48 = __pyx_v_l;
              __pyx_t_49 = (__pyx_v_i + (4 * (__pyx_v_j + (4 * __pyx_v_k))));
              *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xi_cube.data + __pyx_t_48 * __pyx_v_xi_cube.strides[0]) )) + __pyx_t_49)) )) = (-(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_tmp_xi.data) + __pyx_t_47)) ))));
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">0691</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:                             <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            for (__pyx_t_46 = 0; __pyx_t_46 &lt; 3; __pyx_t_46+=1) {
              __pyx_v_l = __pyx_t_46;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:                                 <span class="n">xi_cube</span><span class="p">[</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mf">4</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mf">4</span><span class="o">*</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tmp_xi</span><span class="p">[</span><span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_t_50 = __pyx_v_l;
              __pyx_t_51 = __pyx_v_l;
              __pyx_t_52 = (__pyx_v_i + (4 * (__pyx_v_j + (4 * __pyx_v_k))));
              *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xi_cube.data + __pyx_t_51 * __pyx_v_xi_cube.strides[0]) )) + __pyx_t_52)) )) = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_tmp_xi.data) + __pyx_t_50)) )));
            }
          }
          __pyx_L24:;
        }
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">itpx</span><span class="o">.</span><span class="n">init_interp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">y_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">z_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ky</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kz</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_53 = 0;
    __pyx_t_54 = 0;
    __pyx_t_55 = 0;
    __pyx_t_56 = 0;
    __pyx_t_57 = 0;
    try {
      __pyx_v_self-&gt;itpx-&gt;init_interp((&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x_cube.data) + __pyx_t_53)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y_cube.data) + __pyx_t_54)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z_cube.data) + __pyx_t_55)) )))), (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xi_cube.data + __pyx_t_56 * __pyx_v_xi_cube.strides[0]) )) + __pyx_t_57)) )))), __pyx_v_self-&gt;kx, __pyx_v_self-&gt;ky, __pyx_v_self-&gt;kz, 4, 4, 4, 0);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(1, 695, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">itpy</span><span class="o">.</span><span class="n">init_interp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">y_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">z_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ky</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kz</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_58 = 0;
    __pyx_t_59 = 0;
    __pyx_t_60 = 0;
    __pyx_t_61 = 1;
    __pyx_t_62 = 0;
    try {
      __pyx_v_self-&gt;itpy-&gt;init_interp((&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x_cube.data) + __pyx_t_58)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y_cube.data) + __pyx_t_59)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z_cube.data) + __pyx_t_60)) )))), (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xi_cube.data + __pyx_t_61 * __pyx_v_xi_cube.strides[0]) )) + __pyx_t_62)) )))), __pyx_v_self-&gt;kx, __pyx_v_self-&gt;ky, __pyx_v_self-&gt;kz, 4, 4, 4, 0);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(1, 696, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">itpz</span><span class="o">.</span><span class="n">init_interp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">y_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">z_cube</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="o">&amp;</span><span class="n">xi_cube</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ky</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kz</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_63 = 0;
    __pyx_t_64 = 0;
    __pyx_t_65 = 0;
    __pyx_t_66 = 2;
    __pyx_t_67 = 0;
    try {
      __pyx_v_self-&gt;itpz-&gt;init_interp((&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x_cube.data) + __pyx_t_63)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y_cube.data) + __pyx_t_64)) )))), (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z_cube.data) + __pyx_t_65)) )))), (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xi_cube.data + __pyx_t_66 * __pyx_v_xi_cube.strides[0]) )) + __pyx_t_67)) )))), __pyx_v_self-&gt;kx, __pyx_v_self-&gt;ky, __pyx_v_self-&gt;kz, 4, 4, 4, 0);
    } catch(...) {
      __Pyx_CppExn2PyErr();
      <span class='error_goto'>__PYX_ERR(1, 697, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">calibrated</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;calibrated = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0699</span>:         <span class="c"># Evaluate interpolation objects</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:         <span class="n">xi</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpx</span><span class="o">.</span><span class="n">eval_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_10 = __pyx_v_self-&gt;itpx-&gt;eval_interp(__pyx_v_x, __pyx_v_y, __pyx_v_z, 0, 0, 0);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 700, __pyx_L1_error)</span>
  }
  __pyx_t_68 = 0;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_xi.data) + __pyx_t_68)) )) = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:         <span class="n">xi</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpy</span><span class="o">.</span><span class="n">eval_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_10 = __pyx_v_self-&gt;itpy-&gt;eval_interp(__pyx_v_x, __pyx_v_y, __pyx_v_z, 0, 0, 0);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 701, __pyx_L1_error)</span>
  }
  __pyx_t_69 = 1;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_xi.data) + __pyx_t_69)) )) = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:         <span class="n">xi</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpz</span><span class="o">.</span><span class="n">eval_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  try {
    __pyx_t_10 = __pyx_v_self-&gt;itpz-&gt;eval_interp(__pyx_v_x, __pyx_v_y, __pyx_v_z, 0, 0, 0);
  } catch(...) {
    __Pyx_CppExn2PyErr();
    <span class='error_goto'>__PYX_ERR(1, 702, __pyx_L1_error)</span>
  }
  __pyx_t_70 = 2;
  *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_xi.data) + __pyx_t_70)) )) = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0703</span>:         <span class="c"># Normalize results</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:         <span class="n">_cy_normalize_</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration__cy_normalize_(__pyx_v_xi);
</pre><pre class="cython line score-0">&#xA0;<span class="">0705</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0710</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_set_voxel_indices_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">double</span> <span class="n">y</span><span class="p">,</span> <span class="n">double</span> <span class="n">z</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_24CubicSpecialInterpolator__set_voxel_indices_(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self, double __pyx_v_x, double __pyx_v_y, double __pyx_v_z) {
  __Pyx_memviewslice __pyx_v_inds_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_inds_y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_inds_z = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_ind_x;
  int __pyx_v_ind_y;
  int __pyx_v_ind_z;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_set_voxel_indices_", 0);
/* … */
  /* function exit code */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds_z, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0711</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0712</span>: <span class="sd">        CubicSpecialInterpolator._set_voxel_indices_(x,y,z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>: <span class="sd">        The C-level function which determines the interpolation voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: <span class="sd">        x : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span class="sd">           The x-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>: <span class="sd">        y : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="sd">           The y-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="sd">        z : d ouble</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: <span class="sd">           The z-coordinate at which an interpolated vector is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0727</span>:             <span class="nb">int</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">inds_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_x</span><span class="p">,</span> <span class="n">inds_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_y</span><span class="p">,</span> <span class="n">inds_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_z</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;inds_x;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_inds_x = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;inds_y;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_inds_y = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;inds_z;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_inds_z = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0728</span>:             <span class="nb">int</span> <span class="n">ind_x</span><span class="p">,</span> <span class="n">ind_y</span><span class="p">,</span> <span class="n">ind_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:         <span class="n">x</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_v_x = fmod(((__pyx_v_x - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;x_grid.data) + __pyx_t_2)) )))) / __pyx_v_self-&gt;dx), __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0731</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_y = fmod(((__pyx_v_y - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;y_grid.data) + __pyx_t_3)) )))) / __pyx_v_self-&gt;dy), __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0732</span>:         <span class="n">z</span> <span class="o">=</span> <span class="n">c_fmod</span><span class="p">((</span><span class="n">z</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">z_grid</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_z = fmod(((__pyx_v_z - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_self-&gt;z_grid.data) + __pyx_t_4)) )))) / __pyx_v_self-&gt;dz), __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0733</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:         <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_5 = ((__pyx_v_x &lt; 0.0) != 0);
    if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:             <span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-0 '>    __pyx_v_x = (__pyx_v_x + __pyx_v_self-&gt;nx);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         <span class="k">while</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_5 = ((__pyx_v_y &lt; 0.0) != 0);
    if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:             <span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>    __pyx_v_y = (__pyx_v_y + __pyx_v_self-&gt;ny);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:         <span class="k">while</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_5 = ((__pyx_v_z &lt; 0.0) != 0);
    if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:             <span class="n">z</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>    __pyx_v_z = (__pyx_v_z + __pyx_v_self-&gt;nz);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0740</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0741</span>:         <span class="n">ind_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind_x = ((int)floor(__pyx_v_x));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>:         <span class="n">ind_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind_y = ((int)floor(__pyx_v_y));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:         <span class="n">ind_z</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c_floor</span><span class="p">(</span><span class="n">z</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind_z = ((int)floor(__pyx_v_z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0744</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inds_x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ind_x</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_y</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ind_y</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_self-&gt;calibrated != 0)) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L10_bool_binop_done;
  }
  __pyx_t_7 = 1;
  __pyx_t_6 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_self-&gt;inds_x.data) + __pyx_t_7)) ))) != __pyx_v_ind_x) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L10_bool_binop_done;
  }
/* … */
  __pyx_t_8 = 1;
/* … */
  __pyx_t_6 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_self-&gt;inds_y.data) + __pyx_t_8)) ))) != __pyx_v_ind_y) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L10_bool_binop_done;
  }
/* … */
  if (__pyx_t_5) {
/* … */
    goto __pyx_L9;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:                                     <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_z</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ind_z</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = 1;
  __pyx_t_6 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_self-&gt;inds_z.data) + __pyx_t_9)) ))) != __pyx_v_ind_z) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L10_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0747</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:             <span class="n">inds_x</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = 1;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_10)) )) = __pyx_v_ind_x;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0749</span>:             <span class="n">inds_y</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = 1;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_11)) )) = __pyx_v_ind_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:             <span class="n">inds_z</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = 1;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_12)) )) = __pyx_v_ind_z;
</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:             <span class="n">inds_x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_x</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_13)) )) = ((__pyx_v_ind_x - 1) % __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:             <span class="n">inds_x</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_x</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = 2;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_14)) )) = ((__pyx_v_ind_x + 1) % __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:             <span class="n">inds_x</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_x</span><span class="o">+</span><span class="mf">2</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 3;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_15)) )) = ((__pyx_v_ind_x + 2) % __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0">&#xA0;<span class="">0755</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:             <span class="k">while</span> <span class="n">inds_x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_16 = 0;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_16)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:                 <span class="n">inds_x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = 0;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_17)) )) += __pyx_v_self-&gt;nx;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:             <span class="k">while</span> <span class="n">inds_x</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_18 = 2;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_18)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:                 <span class="n">inds_x</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 2;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_19)) )) += __pyx_v_self-&gt;nx;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:             <span class="k">while</span> <span class="n">inds_x</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_20 = 3;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_20)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:                 <span class="n">inds_x</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = 3;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_x.data) + __pyx_t_21)) )) += __pyx_v_self-&gt;nx;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:             <span class="n">inds_y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_y</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_22 = 0;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_22)) )) = ((__pyx_v_ind_y - 1) % __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:             <span class="n">inds_y</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_y</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = 2;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_23)) )) = ((__pyx_v_ind_y + 1) % __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:             <span class="n">inds_y</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_y</span><span class="o">+</span><span class="mf">2</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = 3;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_24)) )) = ((__pyx_v_ind_y + 2) % __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0">&#xA0;<span class="">0766</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:             <span class="k">while</span> <span class="n">inds_y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_25 = 0;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_25)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:                 <span class="n">inds_y</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = 0;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_26)) )) += __pyx_v_self-&gt;ny;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0769</span>:             <span class="k">while</span> <span class="n">inds_y</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_27 = 2;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_27)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:                 <span class="n">inds_y</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>      __pyx_t_28 = 2;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_28)) )) += __pyx_v_self-&gt;ny;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:             <span class="k">while</span> <span class="n">inds_y</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_29 = 3;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_29)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:                 <span class="n">inds_y</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-0 '>      __pyx_t_30 = 3;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_y.data) + __pyx_t_30)) )) += __pyx_v_self-&gt;ny;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0773</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:             <span class="n">inds_z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_z</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_31 = 0;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_31)) )) = ((__pyx_v_ind_z - 1) % __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0775</span>:             <span class="n">inds_z</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_z</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_32 = 2;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_32)) )) = ((__pyx_v_ind_z + 1) % __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:             <span class="n">inds_z</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind_z</span><span class="o">+</span><span class="mf">2</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_33 = 3;
    *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_33)) )) = ((__pyx_v_ind_z + 2) % __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:             <span class="k">while</span> <span class="n">inds_z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_34 = 0;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_34)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0779</span>:                 <span class="n">inds_z</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>      __pyx_t_35 = 0;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_35)) )) += __pyx_v_self-&gt;nz;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:             <span class="k">while</span> <span class="n">inds_z</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_36 = 2;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_36)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:                 <span class="n">inds_z</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>      __pyx_t_37 = 2;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_37)) )) += __pyx_v_self-&gt;nz;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>:             <span class="k">while</span> <span class="n">inds_z</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_38 = 3;
      __pyx_t_5 = (((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_38)) ))) &lt; 0) != 0);
      if (!__pyx_t_5) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:                 <span class="n">inds_z</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>      __pyx_t_39 = 3;
      *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_inds_z.data) + __pyx_t_39)) )) += __pyx_v_self-&gt;nz;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sameaslast</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;sameaslast = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0786</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sameaslast</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_self-&gt;sameaslast = 1;
  }
  __pyx_L9:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0788</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:     <span class="k">def</span> <span class="nf">__dealoc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_7__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_24CubicSpecialInterpolator_7__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__ (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_6__dealoc__(((struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24CubicSpecialInterpolator_6__dealoc__(struct __pyx_obj_33straininterpolationandintegration_CubicSpecialInterpolator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;itpx != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:             <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpx</span></pre>
<pre class='cython code score-0 '>    delete __pyx_v_self-&gt;itpx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;itpy != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0793</span>:             <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpy</span></pre>
<pre class='cython code score-0 '>    delete __pyx_v_self-&gt;itpy;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;itpz != NULL) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0795</span>:             <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">itpz</span></pre>
<pre class='cython code score-0 '>    delete __pyx_v_self-&gt;itpz;
</pre><pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">StrainDirectionGenerator</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator {
  PyObject_HEAD
  struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_vtab;
  double _tan_vec_[3];
  double _prev_vec_[3];
  double _xi_[3];
  double _ret_[3];
  __Pyx_memviewslice tan_vec;
  __Pyx_memviewslice prev_vec;
  __Pyx_memviewslice xi;
  __Pyx_memviewslice ret;
  struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *xi_itp;
  int initialized_tan;
  int initialized_prev;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator {
  void (*_ev_)(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *, __Pyx_memviewslice, __Pyx_memviewslice &amp;);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_vtabptr_33straininterpolationandintegration_StrainDirectionGenerator;

</pre><pre class="cython line score-0">&#xA0;<span class="">0799</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="sd">    A Cython extension type intended to be used in conjunction with a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>: <span class="sd">    Dp87Strain instance, whereupon the StrainDirectionGenerator provides</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: <span class="sd">    &quot;slopes&quot; for the Dp87Strain to generate trajectories.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: <span class="sd">    Methods defined here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>: <span class="sd">    StrainDirectionGenerator.__init__(xi_itp)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: <span class="sd">    StrainDirectionGenerator.set_tan_vec(tan_vec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">    StrainDirectionGenerator.unset_tan_vec()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="sd">    StrainDirectionGenerator.set_prev_vec(prev_vec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="sd">    StrainDirectionGenerator.unset_prev_vec()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="sd">    StrainDirectionGenerator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>: <span class="sd">    Version: 1.0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:         <span class="n">double</span> <span class="n">_tan_vec_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>:         <span class="n">double</span> <span class="n">_prev_vec_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:         <span class="n">double</span> <span class="n">_xi_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>:         <span class="n">double</span> <span class="n">_ret_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">tan_vec</span><span class="p">,</span> <span class="n">prev_vec</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">ret</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:         <span class="n">InterpolatorWithOrientationFix</span> <span class="n">xi_itp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:         <span class="n">bint</span> <span class="n">initialized_tan</span><span class="p">,</span> <span class="n">initialized_prev</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator___cinit__(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator___cinit__(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0825</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">tan_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tan_vec_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_tan_vec_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 825, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 825, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = __pyx_array_new(__pyx_t_3, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 825, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 825, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;tan_vec, 0);
  __pyx_v_self-&gt;tan_vec = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0826</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">prev_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prev_vec_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_prev_vec_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 826, __pyx_L1_error)</span>
  }
  __pyx_t_3 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_3 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_3))) <span class='error_goto'>__PYX_ERR(1, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_3), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;prev_vec, 0);
  __pyx_v_self-&gt;prev_vec = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0827</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xi_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_xi_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 827, __pyx_L1_error)</span>
  }
  __pyx_t_4 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_4 || !__pyx_t_3 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_4))) <span class='error_goto'>__PYX_ERR(1, 827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = __pyx_array_new(__pyx_t_3, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_4), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 827, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xi, 0);
  __pyx_v_self-&gt;xi = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ret_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = __pyx_v_self-&gt;_ret_;
  if (!__pyx_t_1) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 828, __pyx_L1_error)</span>
  }
  __pyx_t_3 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_4 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_3 || !__pyx_t_4 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_3))) <span class='error_goto'>__PYX_ERR(1, 828, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = __pyx_array_new(__pyx_t_4, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_3), (char *) "fortran", (char *) __pyx_t_1);
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(1, 828, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(1, 828, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ret, 0);
  __pyx_v_self-&gt;ret = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0829</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_tan</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_tan = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_prev</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_prev = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InterpolatorWithOrientationFix</span> <span class="n">xi_itp</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_2__init__[] = "\n        StrainDirectionGenerator.__init__(xi_itp)\n\n        Constructor for a StrainDirectionGenerator instance.\n\n        Parameters\n        ----------\n        xi_itp : LinearSpecialInterpolator or CubicSpecialInterpolator\n           Special interpolation extension type which has been initialized\n           with the underlying vector field.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_24StrainDirectionGenerator_2__init__;
#endif
static int __pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_xi_itp = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xi_itp,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xi_itp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 835, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_xi_itp = ((struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *)values[0]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 835, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_xi_itp), __pyx_ptype_33straininterpolationandintegration_InterpolatorWithOrientationFix, 1, "xi_itp", 0))) <span class='error_goto'>__PYX_ERR(1, 835, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_2__init__(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self), __pyx_v_xi_itp);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_2__init__(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self, struct __pyx_obj_33straininterpolationandintegration_InterpolatorWithOrientationFix *__pyx_v_xi_itp) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0836</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>: <span class="sd">        StrainDirectionGenerator.__init__(xi_itp)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0839</span>: <span class="sd">        Constructor for a StrainDirectionGenerator instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>: <span class="sd">        xi_itp : LinearSpecialInterpolator or CubicSpecialInterpolator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>: <span class="sd">           Special interpolation extension type which has been initialized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>: <span class="sd">           with the underlying vector field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_itp</span> <span class="o">=</span> <span class="n">xi_itp</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_xi_itp));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_xi_itp));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;xi_itp);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;xi_itp));
  __pyx_v_self-&gt;xi_itp = __pyx_v_xi_itp;
</pre><pre class="cython line score-0">&#xA0;<span class="">0849</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:     <span class="k">def</span> <span class="nf">set_tan_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">tan_vec</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_5set_tan_vec(PyObject *__pyx_v_self, PyObject *__pyx_arg_tan_vec); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_4set_tan_vec[] = "\n        StrainDirectionGenerator.set_tan_vec(tan_vec)\n\n        Function which sets the approximately tangent vector, to be used in\n        conjunction with the underlying vector field in order to\n        generate step directions in R^3.\n\n        Must be called prior to StrainDirectionGenerator.__call__.\n\n        Parameters\n        ----------\n        tan_vec : (3,) ndarray\n           A (C-contiguous) NumPy array, containing the (approximately) tangent\n           vector.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_5set_tan_vec(PyObject *__pyx_v_self, PyObject *__pyx_arg_tan_vec) {
  __Pyx_memviewslice __pyx_v_tan_vec = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_tan_vec (wrapper)", 0);
  assert(__pyx_arg_tan_vec); {
    __pyx_v_tan_vec = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_arg_tan_vec, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_tan_vec.memview)) __PYX_ERR(1, 853, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.set_tan_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_tan_vec.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "tan_vec"); <span class='error_goto'>__PYX_ERR(1, 853, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_4set_tan_vec(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self), __pyx_v_tan_vec);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_4set_tan_vec(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self, __Pyx_memviewslice __pyx_v_tan_vec) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_tan_vec", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.set_tan_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tan_vec, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0854</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>: <span class="sd">        StrainDirectionGenerator.set_tan_vec(tan_vec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="sd">        Function which sets the approximately tangent vector, to be used in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: <span class="sd">        conjunction with the underlying vector field in order to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span class="sd">        generate step directions in R^3.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">        Must be called prior to StrainDirectionGenerator.__call__.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        tan_vec : (3,) ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: <span class="sd">           A (C-contiguous) NumPy array, containing the (approximately) tangent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0870</span>:         <span class="k">if</span> <span class="n">tan_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_tan_vec.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0871</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolation-aiming routine is custom-built&#39;</span> \</pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 871, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0872</span>:                     <span class="o">+</span> <span class="s">&#39; for three-dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_The_interpolation_aiming_routine, __pyx_kp_s_for_three_dimensional_data);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0873</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0874</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">tan_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tan_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_tan_vec, 1, __pyx_v_self-&gt;tan_vec, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:         <span class="n">_cy_normalize_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tan_vec</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration__cy_normalize_(__pyx_v_self-&gt;tan_vec);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0876</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_tan</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_tan = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0877</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0878</span>:     <span class="k">def</span> <span class="nf">unset_tan_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_7unset_tan_vec(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_6unset_tan_vec[] = "\n        StrainDirectionGenerator.unset_tan_vec()\n\n        Unsets the tangent vector.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_7unset_tan_vec(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_tan_vec (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_6unset_tan_vec(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_6unset_tan_vec(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_tan_vec", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0879</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: <span class="sd">        StrainDirectionGenerator.unset_tan_vec()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: <span class="sd">        Unsets the tangent vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_tan</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_tan = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0886</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:     <span class="k">def</span> <span class="nf">set_prev_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">prev_vec</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_9set_prev_vec(PyObject *__pyx_v_self, PyObject *__pyx_arg_prev_vec); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_8set_prev_vec[] = "\n        StrainDirectionGenerator.set_prev_vec(prev_vec)\n\n        Function which sets the previous vector, which is used in order\n        to ensure that any trajectory does not instantaneously fold onto\n        itself in regions with strong orientational discontinuities.\n\n        Must be called prior to StrainDirectionGenerator.__call__.\n\n        Parameters\n        ----------\n        prev_vec : (3,) ndarray\n           A (C-contiguous) NumPy array, containing the (approximately) prevgent\n           vector.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_9set_prev_vec(PyObject *__pyx_v_self, PyObject *__pyx_arg_prev_vec) {
  __Pyx_memviewslice __pyx_v_prev_vec = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_prev_vec (wrapper)", 0);
  assert(__pyx_arg_prev_vec); {
    __pyx_v_prev_vec = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_arg_prev_vec, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_prev_vec.memview)) __PYX_ERR(1, 890, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.set_prev_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_prev_vec.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "prev_vec"); <span class='error_goto'>__PYX_ERR(1, 890, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_8set_prev_vec(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self), __pyx_v_prev_vec);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_8set_prev_vec(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self, __Pyx_memviewslice __pyx_v_prev_vec) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_prev_vec", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.set_prev_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_prev_vec, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0891</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>: <span class="sd">        StrainDirectionGenerator.set_prev_vec(prev_vec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: <span class="sd">        Function which sets the previous vector, which is used in order</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: <span class="sd">        to ensure that any trajectory does not instantaneously fold onto</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: <span class="sd">        itself in regions with strong orientational discontinuities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: <span class="sd">        Must be called prior to StrainDirectionGenerator.__call__.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="sd">        prev_vec : (3,) ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: <span class="sd">           A (C-contiguous) NumPy array, containing the (approximately) prevgent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>: <span class="sd">           vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:         <span class="k">if</span> <span class="n">prev_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_prev_vec.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolation-aiming routine is custom-built&#39;</span> \</pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 908, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 908, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:                     <span class="o">+</span> <span class="s">&#39; for three-dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_The_interpolation_aiming_routine, __pyx_kp_s_for_three_dimensional_data);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0910</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">prev_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_prev_vec, 1, __pyx_v_self-&gt;prev_vec, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>:         <span class="n">_cy_normalize_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_vec</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration__cy_normalize_(__pyx_v_self-&gt;prev_vec);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_prev</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_prev = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0915</span>:     <span class="k">def</span> <span class="nf">unset_prev_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_11unset_prev_vec(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_10unset_prev_vec[] = "\n        StrainDirectionGenerator.unset_prev_vec()\n\n        Unsets the previous vector.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_11unset_prev_vec(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_prev_vec (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_10unset_prev_vec(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_10unset_prev_vec(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_prev_vec", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0916</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>: <span class="sd">        StrainDirectionGenerator.unset_prev_vec()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0919</span>: <span class="sd">        Unsets the previous vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0920</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0922</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized_prev</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized_prev = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_13__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_24StrainDirectionGenerator_12__call__[] = "\n        StrainDirectionGenerator.__call__(pos)\n\n        Generates a trajectory direction at pos, based upon the underlying\n        vector field and the pre-set tan_vec and prev_vec.\n\n        Parameters\n        ----------\n        pos : (3,) array-like\n           A (C-contiguous) NumPy array containing the (Cartesian) coordinates\n           of the point in R^3 at which a direction is sought.\n\n        Returns\n        -------\n        vec : (3,) ndarray\n           A (C-contiguous) NumPy array containing the normalized direction.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_24StrainDirectionGenerator_12__call__;
#endif
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_13__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 927, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(1, 927, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 927, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_pos.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "pos"); <span class='error_goto'>__PYX_ERR(1, 927, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_12__call__(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self), __pyx_v_pos);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_12__call__(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.StrainDirectionGenerator.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: <span class="sd">        StrainDirectionGenerator.__call__(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: <span class="sd">        Generates a trajectory direction at pos, based upon the underlying</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: <span class="sd">        vector field and the pre-set tan_vec and prev_vec.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: <span class="sd">           A (C-contiguous) NumPy array containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>: <span class="sd">           of the point in R^3 at which a direction is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>: <span class="sd">        vec : (3,) ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: <span class="sd">           A (C-contiguous) NumPy array containing the normalized direction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0946</span>:         <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_pos.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0947</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The interpolation-aiming routine is custom-built&#39;</span> \</pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 947, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 947, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0948</span>:                     <span class="o">+</span> <span class="s">&#39; for three dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_The_interpolation_aiming_routine, __pyx_kp_s_for_three_dimensional_data_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 948, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0949</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0950</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialized_tan</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_prev</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = (__pyx_v_self-&gt;initialized_tan != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_4 = (__pyx_v_self-&gt;initialized_prev != 0);
  __pyx_t_1 = __pyx_t_4;
  __pyx_L5_bool_binop_done:;
  __pyx_t_4 = ((!__pyx_t_1) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0951</span>:             <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;Aim assister not initialized with tan_vec and/or prev_vec!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 951, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 951, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Aim_assister_not_initialized_wit);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(1, 951, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0952</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self, __pyx_v_pos, __pyx_v_self-&gt;ret);
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0953</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;ret, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 953, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0954</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0958</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_ev_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">ret</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_24StrainDirectionGenerator__ev_(struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice &amp;__pyx_v_ret) {
  __Pyx_memviewslice __pyx_v_xi = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_ev_", 0);
/* … */
  /* function exit code */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xi, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0959</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">        StrainDirectionGenerator._ev_(pos,ret)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">        The C-level function which actually generates the sought direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span class="sd">        at pos, based upon the underlying vector field and the pre-set tan_vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span class="sd">        and prev_vec.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>: <span class="sd">        pos : (3,) array-like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: <span class="sd">           A (C-contiguous) memoryview containing the (Cartesian) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: <span class="sd">           of the point in R^3 at which a direction is sought.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>: <span class="sd">        ret : (3,) array-like, intent = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>: <span class="sd">           Upon exit, a (C-contiguous) memoryview containing the normalized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>: <span class="sd">           direction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0977</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;xi;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_xi = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0978</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0979</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xi_itp</span><span class="o">.</span><span class="n">_interpolate_xi_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xi</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_InterpolatorWithOrientationFix *)__pyx_v_self-&gt;xi_itp-&gt;__pyx_vtab)-&gt;_interpolate_xi_(__pyx_v_self-&gt;xi_itp, __pyx_v_pos, __pyx_v_xi);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:         <span class="k">if</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">c_pow</span><span class="p">(</span><span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tan_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">),</span><span class="mf">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((1.0 - pow(__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_xi, 1, __pyx_v_self-&gt;tan_vec, 1), 2.0)) &lt; 1e-8) != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0981</span>:             <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">ret</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_self-&gt;prev_vec, 1, __pyx_v_ret, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0982</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0983</span>:             <span class="n">_cy_cross_product_</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tan_vec</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_f_33straininterpolationandintegration__cy_cross_product_(__pyx_v_xi, __pyx_v_self-&gt;tan_vec, __pyx_v_ret);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0984</span>:         <span class="n">_cy_normalize_</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration__cy_normalize_(__pyx_v_ret);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0985</span>:         <span class="k">if</span> <span class="n">ddot</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">ret</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_vec</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_f_33straininterpolationandintegration_ddot(3, __pyx_v_ret, 1, __pyx_v_self-&gt;prev_vec, 1) &lt; 0.0) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:             <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="n">ret</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dscal(3, -1.0, __pyx_v_ret, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0987</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0988</span>:     <span class="k">def</span> <span class="nf">__dealoc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_15__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_33straininterpolationandintegration_24StrainDirectionGenerator_15__dealoc__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__ (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_14__dealoc__(((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_24StrainDirectionGenerator_14__dealoc__(CYTHON_UNUSED struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealoc__", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0989</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Dp87Strain</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_33straininterpolationandintegration_Dp87Strain {
  PyObject_HEAD
  struct __pyx_vtabstruct_33straininterpolationandintegration_Dp87Strain *__pyx_vtab;
  double fac;
  double maxfac;
  double _c_[12];
  __Pyx_memviewslice c;
  double _a1_[1];
  double _a2_[2];
  double _a3_[3];
  double _a4_[4];
  double _a5_[5];
  double _a6_[6];
  double _a7_[7];
  double _a8_[8];
  double _a9_[9];
  double _a10_[10];
  double _a11_[11];
  double _a12_[12];
  double _a13_[13];
  __Pyx_memviewslice a1;
  __Pyx_memviewslice a2;
  __Pyx_memviewslice a3;
  __Pyx_memviewslice a4;
  __Pyx_memviewslice a5;
  __Pyx_memviewslice a6;
  __Pyx_memviewslice a7;
  __Pyx_memviewslice a8;
  __Pyx_memviewslice a9;
  __Pyx_memviewslice a10;
  __Pyx_memviewslice a11;
  __Pyx_memviewslice a12;
  __Pyx_memviewslice a13;
  double _b7_[13];
  double _b8_[13];
  __Pyx_memviewslice b7;
  __Pyx_memviewslice b8;
  double _x7_[3];
  double _x8_[3];
  __Pyx_memviewslice x7;
  __Pyx_memviewslice x8;
  double _k1_[3];
  double _k2_[3];
  double _k3_[3];
  double _k4_[3];
  double _k5_[3];
  double _k6_[3];
  double _k7_[3];
  double _k8_[3];
  double _k9_[3];
  double _k10_[3];
  double _k11_[3];
  double _k12_[3];
  double _k13_[3];
  __Pyx_memviewslice k1;
  __Pyx_memviewslice k2;
  __Pyx_memviewslice k3;
  __Pyx_memviewslice k4;
  __Pyx_memviewslice k5;
  __Pyx_memviewslice k6;
  __Pyx_memviewslice k7;
  __Pyx_memviewslice k8;
  __Pyx_memviewslice k9;
  __Pyx_memviewslice k10;
  __Pyx_memviewslice k11;
  __Pyx_memviewslice k12;
  __Pyx_memviewslice k13;
  double _k_tmp_[3];
  __Pyx_memviewslice k_tmp;
  double _pos_i_[3];
  __Pyx_memviewslice pos_i;
  double tmp;
  double sc;
  double err;
  double h_opt;
  double atol;
  double rtol;
  double hmax;
  double q;
  struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *f;
  int initialized;
};
/* … */
struct __pyx_vtabstruct_33straininterpolationandintegration_Dp87Strain {
  void (*_ev_)(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *, double *, __Pyx_memviewslice, double *);
};
static struct __pyx_vtabstruct_33straininterpolationandintegration_Dp87Strain *__pyx_vtabptr_33straininterpolationandintegration_Dp87Strain;

</pre><pre class="cython line score-0">&#xA0;<span class="">0993</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>: <span class="sd">    A Cython extension type which generates trajectories in R^3 defined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: <span class="sd">    as being orthogonal to a (stationary) vector field, by means of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: <span class="sd">    Dormand-Prince 8(7) adaptive timestep Runge-Kutta method.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: <span class="sd">    The dynamic timestep is implemented roughly as in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>: <span class="sd">       Hairer, Nørsett and Wanner: &quot;Solving ordinary differential equations I</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>: <span class="sd">       -- Nonstiff problems&quot;, pages 167 and 168 in the 2008 ed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1002</span>: <span class="sd">    Methods defined here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>: <span class="sd">    Dp87Strain.__init__(atol,rtol,hmax)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>: <span class="sd">    Dp87Strain.set_direction_generator(direction_generator)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>: <span class="sd">    Dp87Strain.unset_direction_generator()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: <span class="sd">    Dp87Strain.__call__(t,pos,h)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>: <span class="sd">    Version: 1.0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:         <span class="n">double</span> <span class="n">fac</span><span class="p">,</span> <span class="n">maxfac</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>:         <span class="n">double</span> <span class="n">_c_</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>:         <span class="n">double</span> <span class="n">_a1_</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>:         <span class="n">double</span> <span class="n">_a2_</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>:         <span class="n">double</span> <span class="n">_a3_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>:         <span class="n">double</span> <span class="n">_a4_</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>:         <span class="n">double</span> <span class="n">_a5_</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>:         <span class="n">double</span> <span class="n">_a6_</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>:         <span class="n">double</span> <span class="n">_a7_</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>:         <span class="n">double</span> <span class="n">_a8_</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>:         <span class="n">double</span> <span class="n">_a9_</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>:         <span class="n">double</span> <span class="n">_a10_</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1025</span>:         <span class="n">double</span> <span class="n">_a11_</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:         <span class="n">double</span> <span class="n">_a12_</span><span class="p">[</span><span class="mf">12</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>:         <span class="n">double</span> <span class="n">_a13_</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">a6</span><span class="p">,</span> <span class="n">a7</span><span class="p">,</span> <span class="n">a8</span><span class="p">,</span> <span class="n">a9</span><span class="p">,</span> <span class="n">a10</span><span class="p">,</span> <span class="n">a11</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">a13</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>:         <span class="n">double</span> <span class="n">_b7_</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>:         <span class="n">double</span> <span class="n">_b8_</span><span class="p">[</span><span class="mf">13</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">b7</span><span class="p">,</span> <span class="n">b8</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>:         <span class="n">double</span> <span class="n">_x7_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>:         <span class="n">double</span> <span class="n">_x8_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1034</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x7</span><span class="p">,</span> <span class="n">x8</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>:         <span class="n">double</span> <span class="n">_k1_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>:         <span class="n">double</span> <span class="n">_k2_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>:         <span class="n">double</span> <span class="n">_k3_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>:         <span class="n">double</span> <span class="n">_k4_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1039</span>:         <span class="n">double</span> <span class="n">_k5_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>:         <span class="n">double</span> <span class="n">_k6_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>:         <span class="n">double</span> <span class="n">_k7_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>:         <span class="n">double</span> <span class="n">_k8_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>:         <span class="n">double</span> <span class="n">_k9_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>:         <span class="n">double</span> <span class="n">_k10_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>:         <span class="n">double</span> <span class="n">_k11_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>:         <span class="n">double</span> <span class="n">_k12_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>:         <span class="n">double</span> <span class="n">_k13_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">k4</span><span class="p">,</span> <span class="n">k5</span><span class="p">,</span> <span class="n">k6</span><span class="p">,</span> <span class="n">k7</span><span class="p">,</span> <span class="n">k8</span><span class="p">,</span> <span class="n">k9</span><span class="p">,</span> <span class="n">k10</span><span class="p">,</span> <span class="n">k11</span><span class="p">,</span> <span class="n">k12</span><span class="p">,</span> <span class="n">k13</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>:         <span class="n">double</span> <span class="n">_k_tmp_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">k_tmp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>:         <span class="n">double</span> <span class="n">_pos_i_</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>:         <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos_i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>:         <span class="n">double</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">sc</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">h_opt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>:         <span class="n">double</span> <span class="n">atol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">hmax</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>:         <span class="n">double</span> <span class="n">q</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>:         <span class="n">StrainDirectionGenerator</span> <span class="n">f</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>:         <span class="n">bint</span> <span class="n">initialized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_10Dp87Strain_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_33straininterpolationandintegration_10Dp87Strain_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_10Dp87Strain___cinit__(((struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_10Dp87Strain___cinit__(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_17));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.Dp87Strain.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_c_</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.05555555555555555556</span><span class="p">,</span> <span class="mf">0.08333333333333333333</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.3125</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.1475</span><span class="p">,</span> <span class="mf">0.465</span><span class="p">,</span> <span class="mf">0.56486545138225957359</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.92465627764050444674</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1[0] = 0.05555555555555555556;
  __pyx_t_1[1] = 0.08333333333333333333;
  __pyx_t_1[2] = 0.125;
  __pyx_t_1[3] = 0.3125;
  __pyx_t_1[4] = 0.375;
  __pyx_t_1[5] = 0.1475;
  __pyx_t_1[6] = 0.465;
  __pyx_t_1[7] = 0.56486545138225957359;
  __pyx_t_1[8] = 0.65;
  __pyx_t_1[9] = 0.92465627764050444674;
  __pyx_t_1[10] = 1.;
  __pyx_t_1[11] = 1.;
  memcpy(&amp;(__pyx_v_self-&gt;_c_[0]), __pyx_t_1, sizeof(__pyx_v_self-&gt;_c_[0]) * (12));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1062</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a1_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05555555555555555556</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2[0] = 0.05555555555555555556;
  memcpy(&amp;(__pyx_v_self-&gt;_a1_[0]), __pyx_t_2, sizeof(__pyx_v_self-&gt;_a1_[0]) * (1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a2_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0208333333333333333</span><span class="p">,</span> <span class="mf">0.0625</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3[0] = 0.0208333333333333333;
  __pyx_t_3[1] = 0.0625;
  memcpy(&amp;(__pyx_v_self-&gt;_a2_[0]), __pyx_t_3, sizeof(__pyx_v_self-&gt;_a2_[0]) * (2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a3_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03125</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.09375</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4[0] = 0.03125;
  __pyx_t_4[1] = 0.;
  __pyx_t_4[2] = 0.09375;
  memcpy(&amp;(__pyx_v_self-&gt;_a3_[0]), __pyx_t_4, sizeof(__pyx_v_self-&gt;_a3_[0]) * (3));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a4_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3125</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.17185</span><span class="p">,</span> <span class="mf">1.17185</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5[0] = 0.3125;
  __pyx_t_5[1] = 0.;
  __pyx_t_5[2] = -1.17185;
  __pyx_t_5[3] = 1.17185;
  memcpy(&amp;(__pyx_v_self-&gt;_a4_[0]), __pyx_t_5, sizeof(__pyx_v_self-&gt;_a4_[0]) * (4));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a5_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0375</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1875</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6[0] = 0.0375;
  __pyx_t_6[1] = 0.;
  __pyx_t_6[2] = 0.;
  __pyx_t_6[3] = 0.1875;
  __pyx_t_6[4] = 0.15;
  memcpy(&amp;(__pyx_v_self-&gt;_a5_[0]), __pyx_t_6, sizeof(__pyx_v_self-&gt;_a5_[0]) * (5));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a6_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04791013711111111111</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.11224871277777777777</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02550567377777777777</span><span class="p">,</span> <span class="mf">0.012846823888888888</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7[0] = 0.04791013711111111111;
  __pyx_t_7[1] = 0.;
  __pyx_t_7[2] = 0.;
  __pyx_t_7[3] = 0.11224871277777777777;
  __pyx_t_7[4] = -0.02550567377777777777;
  __pyx_t_7[5] = 0.012846823888888888;
  memcpy(&amp;(__pyx_v_self-&gt;_a6_[0]), __pyx_t_7, sizeof(__pyx_v_self-&gt;_a6_[0]) * (6));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a7_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.016917989787292281</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.387848278486043169</span><span class="p">,</span> <span class="mf">0.035977369851500327</span><span class="p">,</span> <span class="mf">0.196970214215666060</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.172713852340501838</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8[0] = 0.016917989787292281;
  __pyx_t_8[1] = 0.;
  __pyx_t_8[2] = 0.;
  __pyx_t_8[3] = 0.387848278486043169;
  __pyx_t_8[4] = 0.035977369851500327;
  __pyx_t_8[5] = 0.196970214215666060;
  __pyx_t_8[6] = -0.172713852340501838;
  memcpy(&amp;(__pyx_v_self-&gt;_a7_[0]), __pyx_t_8, sizeof(__pyx_v_self-&gt;_a7_[0]) * (7));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a8_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.069095753359192300</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.63424797672885411</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16119757522460408</span><span class="p">,</span> <span class="mf">0.138650309458825255</span><span class="p">,</span> <span class="mf">0.940928614035756269</span><span class="p">,</span> <span class="mf">0.211636326481943981</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9[0] = 0.069095753359192300;
  __pyx_t_9[1] = 0.;
  __pyx_t_9[2] = 0.;
  __pyx_t_9[3] = -0.63424797672885411;
  __pyx_t_9[4] = -0.16119757522460408;
  __pyx_t_9[5] = 0.138650309458825255;
  __pyx_t_9[6] = 0.940928614035756269;
  __pyx_t_9[7] = 0.211636326481943981;
  memcpy(&amp;(__pyx_v_self-&gt;_a8_[0]), __pyx_t_9, sizeof(__pyx_v_self-&gt;_a8_[0]) * (8));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1070</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a9_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.183556996839045385</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.46876808431559245</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29128688781630045</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02647302023311737</span><span class="p">,</span> <span class="mf">2.847838764192800449</span><span class="p">,</span> <span class="mf">0.281387331469849792</span><span class="p">,</span> <span class="mf">0.123744899863314657</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10[0] = 0.183556996839045385;
  __pyx_t_10[1] = 0.;
  __pyx_t_10[2] = 0.;
  __pyx_t_10[3] = -2.46876808431559245;
  __pyx_t_10[4] = -0.29128688781630045;
  __pyx_t_10[5] = -0.02647302023311737;
  __pyx_t_10[6] = 2.847838764192800449;
  __pyx_t_10[7] = 0.281387331469849792;
  __pyx_t_10[8] = 0.123744899863314657;
  memcpy(&amp;(__pyx_v_self-&gt;_a9_[0]), __pyx_t_10, sizeof(__pyx_v_self-&gt;_a9_[0]) * (9));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a10_</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.21542481739588805</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">16.672608665945772432</span><span class="p">,</span> <span class="mf">0.915741828416817960</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.05660580435747094</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.00357359415617811</span><span class="p">,</span> <span class="mf">14.849303086297662557</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.371575735289849318</span><span class="p">,</span> <span class="mf">5.134182648179637933</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11[0] = -1.21542481739588805;
  __pyx_t_11[1] = 0.;
  __pyx_t_11[2] = 0.;
  __pyx_t_11[3] = 16.672608665945772432;
  __pyx_t_11[4] = 0.915741828416817960;
  __pyx_t_11[5] = -6.05660580435747094;
  __pyx_t_11[6] = -16.00357359415617811;
  __pyx_t_11[7] = 14.849303086297662557;
  __pyx_t_11[8] = -13.371575735289849318;
  __pyx_t_11[9] = 5.134182648179637933;
  memcpy(&amp;(__pyx_v_self-&gt;_a10_[0]), __pyx_t_11, sizeof(__pyx_v_self-&gt;_a10_[0]) * (10));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1072</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a11_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.258860916438264283</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.774485785489205112</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.435093013777032509</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.049483332072241509</span><span class="p">,</span> <span class="mf">5.577920039936099117</span><span class="p">,</span> <span class="mf">6.155831589861040689</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.062104586736938370</span><span class="p">,</span> <span class="mf">2.193926173180679061</span><span class="p">,</span> <span class="mf">0.134627998659334941</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12[0] = 0.258860916438264283;
  __pyx_t_12[1] = 0.;
  __pyx_t_12[2] = 0.;
  __pyx_t_12[3] = -4.774485785489205112;
  __pyx_t_12[4] = -0.435093013777032509;
  __pyx_t_12[5] = -3.049483332072241509;
  __pyx_t_12[6] = 5.577920039936099117;
  __pyx_t_12[7] = 6.155831589861040689;
  __pyx_t_12[8] = -5.062104586736938370;
  __pyx_t_12[9] = 2.193926173180679061;
  __pyx_t_12[10] = 0.134627998659334941;
  memcpy(&amp;(__pyx_v_self-&gt;_a11_[0]), __pyx_t_12, sizeof(__pyx_v_self-&gt;_a11_[0]) * (11));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_a12_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.822427599626507477</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">11.658673257277664283</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.757622116690936195</span><span class="p">,</span> <span class="mf">0.713973588159581527</span><span class="p">,</span> <span class="mf">12.075774986890056739</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.127659113920402656</span><span class="p">,</span> <span class="mf">1.990166207048955418</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.234286471544040292</span><span class="p">,</span> <span class="mf">0.175898577707942265</span><span class="p">,</span> <span class="mf">0.</span>  <span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13[0] = 0.822427599626507477;
  __pyx_t_13[1] = 0.;
  __pyx_t_13[2] = 0.;
  __pyx_t_13[3] = -11.658673257277664283;
  __pyx_t_13[4] = -0.757622116690936195;
  __pyx_t_13[5] = 0.713973588159581527;
  __pyx_t_13[6] = 12.075774986890056739;
  __pyx_t_13[7] = -2.127659113920402656;
  __pyx_t_13[8] = 1.990166207048955418;
  __pyx_t_13[9] = -0.234286471544040292;
  __pyx_t_13[10] = 0.175898577707942265;
  __pyx_t_13[11] = 0.;
  memcpy(&amp;(__pyx_v_self-&gt;_a12_[0]), __pyx_t_13, sizeof(__pyx_v_self-&gt;_a12_[0]) * (12));
</pre><pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_b7_</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0295532136763534969</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8286062764877970397</span><span class="p">,</span> <span class="mf">0.3112409000511183279</span><span class="p">,</span> <span class="mf">2.4673451905998869819</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5469416518419087391</span><span class="p">,</span> <span class="mf">1.4435485836767752403</span><span class="p">,</span> <span class="mf">0.0794155958811272872</span><span class="p">,</span> <span class="mf">0.0444444444444444444</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14[0] = 0.0295532136763534969;
  __pyx_t_14[1] = 0.;
  __pyx_t_14[2] = 0.;
  __pyx_t_14[3] = 0.;
  __pyx_t_14[4] = 0.;
  __pyx_t_14[5] = -0.8286062764877970397;
  __pyx_t_14[6] = 0.3112409000511183279;
  __pyx_t_14[7] = 2.4673451905998869819;
  __pyx_t_14[8] = -2.5469416518419087391;
  __pyx_t_14[9] = 1.4435485836767752403;
  __pyx_t_14[10] = 0.0794155958811272872;
  __pyx_t_14[11] = 0.0444444444444444444;
  __pyx_t_14[12] = 0.;
  memcpy(&amp;(__pyx_v_self-&gt;_b7_[0]), __pyx_t_14, sizeof(__pyx_v_self-&gt;_b7_[0]) * (13));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_b8_</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0417474911415302462</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554523286112393089</span><span class="p">,</span> <span class="mf">0.2393128072011800970</span><span class="p">,</span> <span class="mf">0.7035106694034430230</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7597596138144609298</span><span class="p">,</span> <span class="mf">0.6605630309222863414</span><span class="p">,</span> <span class="mf">0.1581874825101233355</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2381095387528628044</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15[0] = 0.0417474911415302462;
  __pyx_t_15[1] = 0.;
  __pyx_t_15[2] = 0.;
  __pyx_t_15[3] = 0.;
  __pyx_t_15[4] = 0.;
  __pyx_t_15[5] = -0.0554523286112393089;
  __pyx_t_15[6] = 0.2393128072011800970;
  __pyx_t_15[7] = 0.7035106694034430230;
  __pyx_t_15[8] = -0.7597596138144609298;
  __pyx_t_15[9] = 0.6605630309222863414;
  __pyx_t_15[10] = 0.1581874825101233355;
  __pyx_t_15[11] = -0.2381095387528628044;
  __pyx_t_15[12] = 0.25;
  memcpy(&amp;(__pyx_v_self-&gt;_b8_[0]), __pyx_t_15, sizeof(__pyx_v_self-&gt;_b8_[0]) * (13));
</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1079</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_c_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1079, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)12));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1079, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1079, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1079, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;c, 0);
  __pyx_v_self-&gt;c = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a1_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a1_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1080, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)1));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1080, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a1, 0);
  __pyx_v_self-&gt;a1 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a2_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a2_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1081, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)2));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1081, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1081, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1081, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a2, 0);
  __pyx_v_self-&gt;a2 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1082</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a3_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a3_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1082, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1082, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1082, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1082, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a3, 0);
  __pyx_v_self-&gt;a3 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a4_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a4_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1083, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)4));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1083, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a4, 0);
  __pyx_v_self-&gt;a4 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a5_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a5_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1084, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)5));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1084, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a5, 0);
  __pyx_v_self-&gt;a5 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a6_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a6_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1085, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)6));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1085, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1085, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1085, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a6, 0);
  __pyx_v_self-&gt;a6 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1086</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a7_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a7_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1086, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)7));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1086, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a7, 0);
  __pyx_v_self-&gt;a7 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a8_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a8_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1087, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)8));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1087, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a8, 0);
  __pyx_v_self-&gt;a8 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a9_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a9_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1088, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)9));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1088, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a9, 0);
  __pyx_v_self-&gt;a9 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1089</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a10_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a10_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1089, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)10));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1089, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a10, 0);
  __pyx_v_self-&gt;a10 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a11_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a11_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1090, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)11));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1090, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a11, 0);
  __pyx_v_self-&gt;a11 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">a12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a12_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_a12_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1091, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)12));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1091, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a12, 0);
  __pyx_v_self-&gt;a12 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">b7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b7_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_b7_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1092, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)13));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1092, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b7, 0);
  __pyx_v_self-&gt;b7 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">b8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b8_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_b8_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1093, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)13));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1093, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1093, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b8, 0);
  __pyx_v_self-&gt;b8 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x7_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_x7_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1094, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1094, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;x7, 0);
  __pyx_v_self-&gt;x7 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x8_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_x8_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1095, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1095, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1095, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1095, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;x8, 0);
  __pyx_v_self-&gt;x8 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k1_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k1_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1097, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1097, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k1, 0);
  __pyx_v_self-&gt;k1 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k2_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k2_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1098, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1098, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1098, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1098, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k2, 0);
  __pyx_v_self-&gt;k2 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k3_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k3_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1099, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1099, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k3, 0);
  __pyx_v_self-&gt;k3 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k4_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k4_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1100, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k4, 0);
  __pyx_v_self-&gt;k4 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1101</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k5_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k5_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1101, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k5, 0);
  __pyx_v_self-&gt;k5 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k6_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k6_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1102, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1102, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k6, 0);
  __pyx_v_self-&gt;k6 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k7_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k7_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1103, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k7, 0);
  __pyx_v_self-&gt;k7 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k8_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k8_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1104, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k8, 0);
  __pyx_v_self-&gt;k8 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k9_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k9_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1105, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1105, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k9, 0);
  __pyx_v_self-&gt;k9 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k10_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k10_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1106, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k10, 0);
  __pyx_v_self-&gt;k10 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k11_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k11_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1107, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1107, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k11, 0);
  __pyx_v_self-&gt;k11 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k12_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k12_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1108, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1108, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k12, 0);
  __pyx_v_self-&gt;k12 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k13_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k13_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1109, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1109, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k13, 0);
  __pyx_v_self-&gt;k13 = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">k_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_k_tmp_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_k_tmp_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1110, __pyx_L1_error)</span>
  }
  __pyx_t_19 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_18 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_19 || !__pyx_t_18 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_19))) <span class='error_goto'>__PYX_ERR(1, 1110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = __pyx_array_new(__pyx_t_18, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_19), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1110, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;k_tmp, 0);
  __pyx_v_self-&gt;k_tmp = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">pos_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_i_</span></pre>
<pre class='cython code score-16 '>  __pyx_t_16 = __pyx_v_self-&gt;_pos_i_;
  if (!__pyx_t_16) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(1, 1112, __pyx_L1_error)</span>
  }
  __pyx_t_18 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);
  __pyx_t_19 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)3));
  if (unlikely(!__pyx_t_18 || !__pyx_t_19 || !<span class='py_c_api'>PyBytes_AsString</span>(__pyx_t_18))) <span class='error_goto'>__PYX_ERR(1, 1112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_17 = __pyx_array_new(__pyx_t_19, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_18), (char *) "fortran", (char *) __pyx_t_16);
  if (unlikely(!__pyx_t_17)) <span class='error_goto'>__PYX_ERR(1, 1112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_t_17), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(1, 1112, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;pos_i, 0);
  __pyx_v_self-&gt;pos_i = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1113</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1114</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="mf">10.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;hmax = 10.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1115</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">fac</span> <span class="o">=</span> <span class="mf">0.8</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;fac = 0.8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">maxfac</span> <span class="o">=</span> <span class="mf">2.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;maxfac = 2.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1117</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="mf">7.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;q = 7.;
</pre><pre class="cython line score-0">&#xA0;<span class="">1118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1120</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1121</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1122</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">atol</span><span class="p">,</span> <span class="n">double</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">double</span> <span class="n">hmax</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">):</span></pre>
<pre class='cython code score-58 '>/* Python wrapper */
static int __pyx_pw_33straininterpolationandintegration_10Dp87Strain_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_10Dp87Strain_2__init__[] = "\n        Dp87Strain.__init__(atol,rtol,hmax)\n\n        Constructor for a Dp87Strain instance.\n\n        Parameters\n        ----------\n        atol : double\n           Absolute tolerance used in the dynamic timestep update\n        rtol : double\n           Relative tolerance used in the dynamic timestep update\n        hmax : double, optional\n           Largest allowed timestep, as a fallback option in the event\n           that the dynamic timestep update would otherwise suggest an\n           infinitely large step. Default: hmax = 10.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_10Dp87Strain_2__init__;
#endif
static int __pyx_pw_33straininterpolationandintegration_10Dp87Strain_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_atol;
  double __pyx_v_rtol;
  double __pyx_v_hmax;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_atol,&amp;__pyx_n_s_rtol,&amp;__pyx_n_s_hmax,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_atol)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rtol)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hmax);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_atol = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_atol == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
    __pyx_v_rtol = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_rtol == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_hmax = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_hmax == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
    } else {
      __pyx_v_hmax = ((double)10.);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 1122, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.Dp87Strain.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_33straininterpolationandintegration_10Dp87Strain_2__init__(((struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self), __pyx_v_atol, __pyx_v_rtol, __pyx_v_hmax);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_33straininterpolationandintegration_10Dp87Strain_2__init__(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self, double __pyx_v_atol, double __pyx_v_rtol, double __pyx_v_hmax) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1123</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1124</span>: <span class="sd">        Dp87Strain.__init__(atol,rtol,hmax)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1126</span>: <span class="sd">        Constructor for a Dp87Strain instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1130</span>: <span class="sd">        atol : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1131</span>: <span class="sd">           Absolute tolerance used in the dynamic timestep update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>: <span class="sd">        rtol : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1133</span>: <span class="sd">           Relative tolerance used in the dynamic timestep update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1134</span>: <span class="sd">        hmax : double, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>: <span class="sd">           Largest allowed timestep, as a fallback option in the event</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1136</span>: <span class="sd">           that the dynamic timestep update would otherwise suggest an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1137</span>: <span class="sd">           infinitely large step. Default: hmax = 10.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1138</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1139</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">atol</span> <span class="o">=</span> <span class="n">atol</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;atol = __pyx_v_atol;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">rtol</span> <span class="o">=</span> <span class="n">rtol</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;rtol = __pyx_v_rtol;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">hmax</span> <span class="o">=</span> <span class="n">hmax</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;hmax = __pyx_v_hmax;
</pre><pre class="cython line score-0">&#xA0;<span class="">1143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1147</span>:     <span class="k">def</span> <span class="nf">set_direction_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">StrainDirectionGenerator</span> <span class="n">direction_generator</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_5set_direction_generator(PyObject *__pyx_v_self, PyObject *__pyx_v_direction_generator); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_10Dp87Strain_4set_direction_generator[] = "\n        Dp87Strain.set_direction_generator(direction_generator)\n\n        Function which sets the StrainDirectionGenerator instance, to be\n        used in order to generate trajectories.\n\n        Must be called prior to Dp87Strain.__call__.\n\n        Parameters\n        ----------\n        direction_generator : StrainDirectionGenerator\n           A (properly initialized, cf. constructor and other methods of a)\n           StrainDirectionGenerator instance.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_5set_direction_generator(PyObject *__pyx_v_self, PyObject *__pyx_v_direction_generator) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_direction_generator (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_direction_generator), __pyx_ptype_33straininterpolationandintegration_StrainDirectionGenerator, 1, "direction_generator", 0))) <span class='error_goto'>__PYX_ERR(1, 1147, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_33straininterpolationandintegration_10Dp87Strain_4set_direction_generator(((struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self), ((struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_direction_generator));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_10Dp87Strain_4set_direction_generator(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self, struct __pyx_obj_33straininterpolationandintegration_StrainDirectionGenerator *__pyx_v_direction_generator) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_direction_generator", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1148</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>: <span class="sd">        Dp87Strain.set_direction_generator(direction_generator)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>: <span class="sd">        Function which sets the StrainDirectionGenerator instance, to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>: <span class="sd">        used in order to generate trajectories.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>: <span class="sd">        Must be called prior to Dp87Strain.__call__.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: <span class="sd">        direction_generator : StrainDirectionGenerator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: <span class="sd">           A (properly initialized, cf. constructor and other methods of a)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>: <span class="sd">           StrainDirectionGenerator instance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">direction_generator</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_direction_generator));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_direction_generator));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;f);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;f));
  __pyx_v_self-&gt;f = __pyx_v_direction_generator;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1165</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1169</span>:     <span class="k">def</span> <span class="nf">unset_direction_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_7unset_direction_generator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_10Dp87Strain_6unset_direction_generator[] = "\n        Dp87Strain.unset_direction_generator()\n\n        Unsets the direction generator.\n\n        ";
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_7unset_direction_generator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_direction_generator (wrapper)", 0);
  __pyx_r = __pyx_pf_33straininterpolationandintegration_10Dp87Strain_6unset_direction_generator(((struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_10Dp87Strain_6unset_direction_generator(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unset_direction_generator", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1170</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1171</span>: <span class="sd">        Dp87Strain.unset_direction_generator()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1173</span>: <span class="sd">        Unsets the direction generator.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1175</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;initialized = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">t</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">double</span> <span class="n">h</span><span class="p">):</span></pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_9__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_33straininterpolationandintegration_10Dp87Strain_8__call__[] = "\n        Dp87Strain.__call__(t,pos,h)\n\n        The function which attempts a step forwards in (pseudo)time along\n        the current trajectory.\n\n        Parameters\n        ----------\n        t : double\n           Current (pseudo)time level\n        pos : (3,) ndarray\n           A (C-contiguous) NumPy array containing the current (Cartesian)\n           coordinates.\n        h : double\n           Current (pseudo)time step\n\n        Returns\n        -------\n        _t : double\n           If the attempted step is rejected, _t = t\n           If the attempted step is accepted, _t = t + h\n        _pos : (3,) ndarray\n           If the attempted step is rejected, _pos = pos\n           If the attempted step is accepted, _pos =/= pos\n        _h : double\n           Updated (pseudo)time step.\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_33straininterpolationandintegration_10Dp87Strain_8__call__;
#endif
static PyObject *__pyx_pw_33straininterpolationandintegration_10Dp87Strain_9__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_t;
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_h;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t,&amp;__pyx_n_s_pos,&amp;__pyx_n_s_h,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_h)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(1, 1181, __pyx_L3_error)</span>
    __pyx_v_h = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_h == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.Dp87Strain.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(((PyObject *)__pyx_v_pos.memview) == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Argument '%.200s' must not be None", "pos"); <span class='error_goto'>__PYX_ERR(1, 1181, __pyx_L1_error)</span>
  }
  __pyx_r = __pyx_pf_33straininterpolationandintegration_10Dp87Strain_8__call__(((struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self), __pyx_v_t, __pyx_v_pos, __pyx_v_h);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_33straininterpolationandintegration_10Dp87Strain_8__call__(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self, double __pyx_v_t, __Pyx_memviewslice __pyx_v_pos, double __pyx_v_h) {
  __Pyx_memviewslice __pyx_v_pos_i = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("straininterpolationandintegration.Dp87Strain.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos_i, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1182</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1183</span>: <span class="sd">        Dp87Strain.__call__(t,pos,h)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>: <span class="sd">        The function which attempts a step forwards in (pseudo)time along</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: <span class="sd">        the current trajectory.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1188</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1189</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>: <span class="sd">        t : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>: <span class="sd">           Current (pseudo)time level</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1192</span>: <span class="sd">        pos : (3,) ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1193</span>: <span class="sd">           A (C-contiguous) NumPy array containing the current (Cartesian)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1194</span>: <span class="sd">           coordinates.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1195</span>: <span class="sd">        h : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>: <span class="sd">           Current (pseudo)time step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1199</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: <span class="sd">        _t : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>: <span class="sd">           If the attempted step is rejected, _t = t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: <span class="sd">           If the attempted step is accepted, _t = t + h</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>: <span class="sd">        _pos : (3,) ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>: <span class="sd">           If the attempted step is rejected, _pos = pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>: <span class="sd">           If the attempted step is accepted, _pos =/= pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>: <span class="sd">        _h : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: <span class="sd">           Updated (pseudo)time step.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1209</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1212</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_i</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;pos_i;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_pos_i = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:         <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_pos.shape[0]) != 3) != 0);
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1214</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The trajectory generating routine is custom-built for three-dimensional data!&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1214, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 1214, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_The_trajectory_generating_routin);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(1, 1214, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1215</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((!(__pyx_v_self-&gt;initialized != 0)) != 0);
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1216</span>:             <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&#39;Dormand-Prince 8(7) strain solver not&#39;</span>\</pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1216, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(1, 1216, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Dormand_Prince_8_7_strain_solver);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(1, 1216, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-0">&#xA0;<span class="">1217</span>:                     <span class="s">&#39; initialized with a StrainDirectionGenerator instance!&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1218</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">pos_i</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_pos_i, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1219</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="o">&amp;</span><span class="n">t</span><span class="p">,</span><span class="n">pos_i</span><span class="p">,</span><span class="o">&amp;</span><span class="n">h</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_Dp87Strain *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self, (&amp;__pyx_v_t), __pyx_v_pos_i, (&amp;__pyx_v_h));
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1220</span>:         <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pos_i</span><span class="p">),</span> <span class="n">h</span></pre>
<pre class='cython code score-63 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_pos_i, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
      PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_5};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
      PyObject *__pyx_temp[2] = {__pyx_t_7, __pyx_t_5};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 1220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_6);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>:     <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1226</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_ev_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="o">*</span><span class="n">h</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_33straininterpolationandintegration_10Dp87Strain__ev_(struct __pyx_obj_33straininterpolationandintegration_Dp87Strain *__pyx_v_self, double *__pyx_v_t, __Pyx_memviewslice __pyx_v_pos, double *__pyx_v_h) {
  __Pyx_memviewslice __pyx_v_k1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k4 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k5 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k6 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k7 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k8 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k9 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k10 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k11 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k12 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k13 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_k_tmp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_x7 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_x8 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_b7 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_b8 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a4 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a5 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a6 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a7 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a8 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a9 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a10 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a11 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a12 = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_a13 = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_ev_", 0);
/* … */
  /* function exit code */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k_tmp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_b7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_b8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a13, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1227</span>:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: <span class="sd">        Dp87Strain._ev_(t,pos,h)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>: <span class="sd">        The C-level function which attempts a step forwards in (pseudo)time</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>: <span class="sd">        along the current trajectory.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: <span class="sd">        t : double, intent = inout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: <span class="sd">           On entry:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: <span class="sd">             Current (pseudo)time level</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: <span class="sd">           On exit:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="sd">             If the attempted step is rejected, _t = t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">             If the attempted step is accepted, _t = t + h</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: <span class="sd">        pos : (3,) ndarray, intent = inout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">           On entry:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">             A (C-contiguous) NumPy array containing the current (Cartesian)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">             coordinates.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">           On exit:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: <span class="sd">             If the attempted step is rejected, _pos = pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="sd">             If the attempted step is accepted, _pos =/= pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>: <span class="sd">        h : double, intent = inoue</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: <span class="sd">           On entry:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>: <span class="sd">             Current (pseudo)time step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: <span class="sd">           On exit:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>: <span class="sd">             Updated (pseudo)time step.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:         <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">k1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">k3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k3</span><span class="p">,</span> <span class="n">k4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k4</span><span class="p">,</span> <span class="n">k5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k5</span><span class="p">,</span> <span class="n">k6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k6</span><span class="p">,</span> <span class="n">k7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k7</span><span class="p">,</span> <span class="n">k8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k8</span><span class="p">,</span> <span class="n">k9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k9</span><span class="p">,</span> <span class="n">k10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k10</span><span class="p">,</span> <span class="n">k11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k11</span><span class="p">,</span> <span class="n">k12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k12</span><span class="p">,</span> <span class="n">k13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k13</span><span class="p">,</span> <span class="n">k_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_tmp</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;k1;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k1 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k2;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k2 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k3;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k3 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k4;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k4 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k5;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k5 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k6;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k6 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k7;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k7 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k8;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k8 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k9;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k9 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k10;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k10 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k11;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k11 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k12;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k12 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k13;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k13 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;k_tmp;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_k_tmp = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">x7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x7</span><span class="p">,</span> <span class="n">x8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x8</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;x7;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_x7 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;x8;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_x8 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1258</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">b7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b7</span><span class="p">,</span> <span class="n">b8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b8</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;b7;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_b7 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;b8;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_b8 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:             <span class="n">double</span><span class="p">[::</span><span class="mf">1</span><span class="p">]</span> <span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span><span class="p">,</span> <span class="n">a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a4</span><span class="p">,</span> <span class="n">a5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a5</span><span class="p">,</span> <span class="n">a6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a6</span><span class="p">,</span> <span class="n">a7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a7</span><span class="p">,</span> <span class="n">a8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a8</span><span class="p">,</span> <span class="n">a9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a9</span><span class="p">,</span> <span class="n">a10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a10</span><span class="p">,</span> <span class="n">a11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a11</span><span class="p">,</span> <span class="n">a12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a12</span><span class="p">,</span> <span class="n">a13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a13</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;a1;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a1 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a2;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a2 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a3;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a3 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a4;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a4 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a5;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a5 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a6;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a6 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a7;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a7 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a8;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a8 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a9;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a9 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a10;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a10 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a11;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a11 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a12;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a12 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_t_1 = __pyx_v_self-&gt;a13;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_a13 = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1260</span>:             <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1261</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">k1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_pos, __pyx_v_k1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a1.data) + __pyx_t_2)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1265</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a2</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a2.data) + __pyx_t_3)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a2</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a2.data) + __pyx_t_4)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1270</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1272</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a3</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a3.data) + __pyx_t_5)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1274</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a3</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a3.data) + __pyx_t_6)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a3</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a3.data) + __pyx_t_7)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1276</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k4</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1278</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1279</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a4</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a4.data) + __pyx_t_8)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1280</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a4</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a4.data) + __pyx_t_9)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1281</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a4</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a4.data) + __pyx_t_10)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a4</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a4.data) + __pyx_t_11)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1283</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k5</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k5);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1285</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1286</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a5</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a5.data) + __pyx_t_12)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1287</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a5</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a5.data) + __pyx_t_13)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1288</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a5</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a5.data) + __pyx_t_14)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1289</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a5</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_15 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a5.data) + __pyx_t_15)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1290</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a5</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_16 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a5.data) + __pyx_t_16)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1291</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1292</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k6</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k6);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1293</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1294</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_17 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_17)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1295</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_18)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1296</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_19 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_19)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1297</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_20 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_20)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1298</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_21 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_21)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a6</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_22 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a6.data) + __pyx_t_22)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1300</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1301</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k7</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k7);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1302</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1303</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_23 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_23)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1304</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_24 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_24)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1305</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_25 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_25)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1306</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_26 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_26)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1307</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_27 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_27)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1308</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_28 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_28)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1309</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a7</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_29 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a7.data) + __pyx_t_29)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1310</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k8</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k8);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1312</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1313</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_30)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1314</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_31 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_31)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1315</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_32 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_32)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1316</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_33 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_33)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_34)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_35 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_35)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1319</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_36 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_36)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a8</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_37 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a8.data) + __pyx_t_37)) ))) * (__pyx_v_h[0])), __pyx_v_k8, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1321</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1322</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k9</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k9);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1324</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_38 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_38)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_39 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_39)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1326</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_40 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_40)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_41 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_41)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1328</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_42 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_42)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_43 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_43)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1330</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_44 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_44)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_45 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_45)) ))) * (__pyx_v_h[0])), __pyx_v_k8, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a9</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_46 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a9.data) + __pyx_t_46)) ))) * (__pyx_v_h[0])), __pyx_v_k9, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1333</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k10</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k10);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_47 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_47)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1337</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_48 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_48)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_49 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_49)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_50 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_50)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_51 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_51)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_52 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_52)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1342</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_53 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_53)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_54 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_54)) ))) * (__pyx_v_h[0])), __pyx_v_k8, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_55 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_55)) ))) * (__pyx_v_h[0])), __pyx_v_k9, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1345</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a10</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k10</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_56 = 9;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a10.data) + __pyx_t_56)) ))) * (__pyx_v_h[0])), __pyx_v_k10, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1346</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1347</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k11</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k11);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1349</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_57 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_57)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1350</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_58 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_58)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_59 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_59)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1352</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_60 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_60)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_61 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_61)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1354</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_62 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_62)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_63 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_63)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_64 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_64)) ))) * (__pyx_v_h[0])), __pyx_v_k8, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1357</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_65 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_65)) ))) * (__pyx_v_h[0])), __pyx_v_k9, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1358</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k10</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_66 = 9;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_66)) ))) * (__pyx_v_h[0])), __pyx_v_k10, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1359</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a11</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k11</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_67 = 10;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a11.data) + __pyx_t_67)) ))) * (__pyx_v_h[0])), __pyx_v_k11, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1360</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k12</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k12);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1362</span>:         <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_pos, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1363</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_68 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_68)) ))) * (__pyx_v_h[0])), __pyx_v_k1, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1364</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_69 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_69)) ))) * (__pyx_v_h[0])), __pyx_v_k2, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1365</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_70 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_70)) ))) * (__pyx_v_h[0])), __pyx_v_k3, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1366</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_71 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_71)) ))) * (__pyx_v_h[0])), __pyx_v_k4, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1367</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_72 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_72)) ))) * (__pyx_v_h[0])), __pyx_v_k5, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1368</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_73 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_73)) ))) * (__pyx_v_h[0])), __pyx_v_k6, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1369</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_74 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_74)) ))) * (__pyx_v_h[0])), __pyx_v_k7, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_75 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_75)) ))) * (__pyx_v_h[0])), __pyx_v_k8, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1371</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_76 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_76)) ))) * (__pyx_v_h[0])), __pyx_v_k9, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1372</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k10</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_77 = 9;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_77)) ))) * (__pyx_v_h[0])), __pyx_v_k10, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1373</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k11</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_78 = 10;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_78)) ))) * (__pyx_v_h[0])), __pyx_v_k11, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1374</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">a12</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k12</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">k_tmp</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_79 = 11;
  __pyx_f_33straininterpolationandintegration_daxpy(3, ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_a12.data) + __pyx_t_79)) ))) * (__pyx_v_h[0])), __pyx_v_k12, 1, __pyx_v_k_tmp, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1375</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">_ev_</span><span class="p">(</span><span class="n">k_tmp</span><span class="p">,</span><span class="n">k13</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_33straininterpolationandintegration_StrainDirectionGenerator *)__pyx_v_self-&gt;f-&gt;__pyx_vtab)-&gt;_ev_(__pyx_v_self-&gt;f, __pyx_v_k_tmp, __pyx_v_k13);
</pre><pre class="cython line score-0">&#xA0;<span class="">1377</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1378</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dscal(3, 0.0, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1379</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dscal(3, 0.0, __pyx_v_x8, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1381</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_80 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_80)) ))), __pyx_v_k1, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1382</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_81 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_81)) ))), __pyx_v_k2, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1383</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_82 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_82)) ))), __pyx_v_k3, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1384</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_83 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_83)) ))), __pyx_v_k4, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1385</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">4</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_84 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_84)) ))), __pyx_v_k5, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1386</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_85 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_85)) ))), __pyx_v_k6, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1387</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_86 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_86)) ))), __pyx_v_k7, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">7</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_87 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_87)) ))), __pyx_v_k8, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1389</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">8</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_88 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_88)) ))), __pyx_v_k9, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1390</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span><span class="n">k10</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_89 = 9;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_89)) ))), __pyx_v_k10, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1391</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span><span class="n">k11</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_90 = 10;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_90)) ))), __pyx_v_k11, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1392</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">11</span><span class="p">],</span><span class="n">k12</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_91 = 11;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_91)) ))), __pyx_v_k12, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1393</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b7</span><span class="p">[</span><span class="mf">12</span><span class="p">],</span><span class="n">k13</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_92 = 12;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b7.data) + __pyx_t_92)) ))), __pyx_v_k13, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1394</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1395</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dscal(3, (__pyx_v_h[0]), __pyx_v_x7, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x7</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_daxpy(3, 1.0, __pyx_v_pos, 1, __pyx_v_x7, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1397</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">k1</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_93 = 0;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_93)) ))), __pyx_v_k1, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span><span class="n">k2</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_94 = 1;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_94)) ))), __pyx_v_k2, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1400</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span><span class="n">k3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_95 = 2;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_95)) ))), __pyx_v_k3, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1401</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span><span class="n">k4</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_96 = 3;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_96)) ))), __pyx_v_k4, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">4</span><span class="p">],</span><span class="n">k5</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_97 = 4;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_97)) ))), __pyx_v_k5, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1403</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">5</span><span class="p">],</span><span class="n">k6</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_98 = 5;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_98)) ))), __pyx_v_k6, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">6</span><span class="p">],</span><span class="n">k7</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_99 = 6;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_99)) ))), __pyx_v_k7, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1405</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">7</span><span class="p">],</span><span class="n">k8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_100 = 7;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_100)) ))), __pyx_v_k8, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1406</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">8</span><span class="p">],</span><span class="n">k9</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_101 = 8;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_101)) ))), __pyx_v_k9, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1407</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">9</span><span class="p">],</span><span class="n">k10</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_102 = 9;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_102)) ))), __pyx_v_k10, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1408</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">10</span><span class="p">],</span><span class="n">k11</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_103 = 10;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_103)) ))), __pyx_v_k11, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1409</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">11</span><span class="p">],</span><span class="n">k12</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_104 = 11;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_104)) ))), __pyx_v_k12, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1410</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">b8</span><span class="p">[</span><span class="mf">12</span><span class="p">],</span><span class="n">k13</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_105 = 12;
  __pyx_f_33straininterpolationandintegration_daxpy(3, (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_b8.data) + __pyx_t_105)) ))), __pyx_v_k13, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1411</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1412</span>:         <span class="n">dscal</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_dscal(3, (__pyx_v_h[0]), __pyx_v_x8, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1413</span>:         <span class="n">daxpy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_33straininterpolationandintegration_daxpy(3, 1.0, __pyx_v_pos, 1, __pyx_v_x8, 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1414</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1415</span>:         <span class="k">if</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_106 = 0;
  __pyx_t_107 = 0;
  __pyx_t_108 = ((fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_106)) )))) &lt; fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_107)) ))))) != 0);
  if (__pyx_t_108) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1416</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atol</span> <span class="o">+</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rtol</span></pre>
<pre class='cython code score-0 '>    __pyx_t_109 = 0;
    __pyx_v_self-&gt;sc = (__pyx_v_self-&gt;atol + (fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x7.data) + __pyx_t_109)) )))) * __pyx_v_self-&gt;rtol));
</pre><pre class="cython line score-0">&#xA0;<span class="">1417</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1418</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atol</span> <span class="o">+</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rtol</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_110 = 0;
    __pyx_v_self-&gt;sc = (__pyx_v_self-&gt;atol + (fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_110)) )))) * __pyx_v_self-&gt;rtol));
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1419</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1420</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="n">x8</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sc</span></pre>
<pre class='cython code score-0 '>  __pyx_t_111 = 0;
  __pyx_t_112 = 0;
  __pyx_v_self-&gt;err = (fabs(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x7.data) + __pyx_t_111)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_112)) ))))) / __pyx_v_self-&gt;sc);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1421</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_113 = 1; __pyx_t_113 &lt; 3; __pyx_t_113+=1) {
    __pyx_v_i = __pyx_t_113;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1422</span>:             <span class="k">if</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_114 = __pyx_v_i;
    __pyx_t_115 = __pyx_v_i;
    __pyx_t_108 = ((fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x7.data) + __pyx_t_114)) )))) &lt; fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_115)) ))))) != 0);
    if (__pyx_t_108) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1423</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atol</span> <span class="o">+</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rtol</span></pre>
<pre class='cython code score-0 '>      __pyx_t_116 = __pyx_v_i;
      __pyx_v_self-&gt;sc = (__pyx_v_self-&gt;atol + (fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x7.data) + __pyx_t_116)) )))) * __pyx_v_self-&gt;rtol));
</pre><pre class="cython line score-0">&#xA0;<span class="">1424</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1425</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atol</span> <span class="o">+</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rtol</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_117 = __pyx_v_i;
      __pyx_v_self-&gt;sc = (__pyx_v_self-&gt;atol + (fabs((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_117)) )))) * __pyx_v_self-&gt;rtol));
    }
    __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1426</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1427</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">c_fabs</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x8</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sc</span></pre>
<pre class='cython code score-0 '>    __pyx_t_118 = __pyx_v_i;
    __pyx_t_119 = __pyx_v_i;
    __pyx_v_self-&gt;tmp = (fabs(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x7.data) + __pyx_t_118)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x8.data) + __pyx_t_119)) ))))) / __pyx_v_self-&gt;sc);
</pre><pre class="cython line score-0">&#xA0;<span class="">1428</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1429</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_108 = ((__pyx_v_self-&gt;tmp &gt; __pyx_v_self-&gt;err) != 0);
    if (__pyx_t_108) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span></pre>
<pre class='cython code score-0 '>      __pyx_t_120 = __pyx_v_self-&gt;tmp;
      __pyx_v_self-&gt;err = __pyx_t_120;
</pre><pre class="cython line score-0">&#xA0;<span class="">1431</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1432</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_108 = ((__pyx_v_self-&gt;err == 0.0) != 0);
  if (__pyx_t_108) {
/* … */
    goto __pyx_L8;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">h_opt</span> <span class="o">=</span> <span class="n">c_copysign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hmax</span><span class="p">,</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;h_opt = copysign(__pyx_v_self-&gt;hmax, (__pyx_v_h[0]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1434</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">h_opt</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">c_pow</span><span class="p">((</span><span class="mf">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">),</span><span class="mf">1</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">+</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_self-&gt;h_opt = ((__pyx_v_h[0]) * pow((1.0 / __pyx_v_self-&gt;err), (1.0 / (__pyx_v_self-&gt;q + 1.0))));
  }
  __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1436</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_108 = ((__pyx_v_self-&gt;err &lt; 1.0) != 0);
  if (__pyx_t_108) {
/* … */
    goto __pyx_L9;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:             <span class="n">t</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_t[0]) = ((__pyx_v_t[0]) + (__pyx_v_h[0]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:             <span class="n">dcopy</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="n">x8</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_33straininterpolationandintegration_dcopy(3, __pyx_v_x8, 1, __pyx_v_pos, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxfac</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fac</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">h_opt</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_108 = (((__pyx_v_self-&gt;maxfac * (__pyx_v_h[0])) &lt; (__pyx_v_self-&gt;fac * __pyx_v_self-&gt;h_opt)) != 0);
    if (__pyx_t_108) {
/* … */
      goto __pyx_L10;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>:                 <span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxfac</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_h[0]) = (__pyx_v_self-&gt;maxfac * (__pyx_v_h[0]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1442</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:                 <span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fac</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">h_opt</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      (__pyx_v_h[0]) = (__pyx_v_self-&gt;fac * __pyx_v_self-&gt;h_opt);
    }
    __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1444</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1445</span>:             <span class="n">h</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fac</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">h_opt</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    (__pyx_v_h[0]) = (__pyx_v_self-&gt;fac * __pyx_v_self-&gt;h_opt);
  }
  __pyx_L9:;
</pre></div></body></html>
